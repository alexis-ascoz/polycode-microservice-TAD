<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<meta name="description" content="This document describes the technical architecture of PolyCode to the microservices migration.">
<meta name="author" content="Alexis Bernard">
<title>PolyCode Technical Architecture Document</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>PolyCode Technical Architecture Document</h1>
<div class="details">
<span id="author" class="author">Alexis Bernard</span><br>
<span id="email" class="email"><a href="mailto:alexisbernard34310@gmail.com">alexisbernard34310@gmail.com</a></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_fonctionnal_quarters">1. Fonctionnal quarters</a>
<ul class="sectlevel2">
<li><a href="#_user_story_vocabulary">1.1. User story vocabulary</a></li>
<li><a href="#_user_stories">1.2. User stories</a></li>
<li><a href="#_polycode_microservices_architecture">1.3. PolyCode microservices architecture</a></li>
</ul>
</li>
<li><a href="#_authentication">2. Authentication</a>
<ul class="sectlevel2">
<li><a href="#_oauth_2_0">2.1. Oauth 2.0</a></li>
<li><a href="#_jwt">2.2. JWT</a></li>
<li><a href="#_pkce">2.3. PKCE</a></li>
<li><a href="#_oauth_2_1">2.4. Oauth 2.1</a></li>
<li><a href="#_sso">2.5. SSO</a></li>
<li><a href="#_openid_connect">2.6. OpenID Connect</a></li>
<li><a href="#_ldap">2.7. LDAP</a></li>
<li><a href="#_tools">2.8. Tools</a></li>
<li><a href="#_polycode_authentication_migration">2.9. PolyCode authentication migration</a></li>
</ul>
</li>
<li><a href="#_inter_process_communication">3. Inter-process communication</a>
<ul class="sectlevel2">
<li><a href="#_methods">3.1. Methods</a></li>
<li><a href="#_architecture_patterns">3.2. Architecture patterns</a></li>
<li><a href="#_service_discovery">3.3. Service discovery</a></li>
<li><a href="#_polycode_integration">3.4. PolyCode integration</a></li>
</ul>
</li>
<li><a href="#_data_management">4. Data Management</a>
<ul class="sectlevel2">
<li><a href="#_data_consistency">4.1. Data Consistency</a></li>
<li><a href="#_data_backup">4.2. Data Backup</a></li>
<li><a href="#_polycode_data_migration">4.3. PolyCode Data Migration</a></li>
</ul>
</li>
<li><a href="#_tracing">5. Tracing</a></li>
<li><a href="#_data_management_2">6. Data Management</a>
<ul class="sectlevel2">
<li><a href="#_data_consistency_2">6.1. Data Consistency</a></li>
<li><a href="#_data_backup_2">6.2. Data Backup</a></li>
<li><a href="#_polycode_data_migration_2">6.3. PolyCode Data Migration</a></li>
</ul>
</li>
<li><a href="#_security">7. Security</a>
<ul class="sectlevel2">
<li><a href="#_application_level">7.1. Application level</a></li>
<li><a href="#_communication_level">7.2. Communication level</a></li>
<li><a href="#_data_security">7.3. Data Security</a></li>
<li><a href="#_secrets_management">7.4. Secrets Management</a></li>
<li><a href="#_polycode_integration_2">7.5. PolyCode Integration</a></li>
</ul>
</li>
<li><a href="#_glossary">Glossary</a></li>
<li><a href="#_bibliography">Bibliography</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Polycode is a web application. His goal is to provide a simple and intuitive way to learn programming, get certifications, participate in coding campaings, and to make coding interviews.</p>
</div>
<div class="paragraph">
<p>The application is available at <a href="https://polycode.do-2021.fr" class="bare">polycode.do-2021.fr</a>.</p>
</div>
<div class="paragraph">
<p>Polycode is actually based on a monolithic architecture. The goal of this document is to explain why and how bring polycode to a microservice architecture, and proof thoose choices by multiples POCs.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="_fonctionnal_quarters"><a class="anchor" href="#_fonctionnal_quarters"></a>1. Fonctionnal quarters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To start with the microservices architecture, it is necessary to define the functional quarters of the application, to initiate a first separation of the application into microservices. A functionnal quarter is define by a set of user stories.</p>
</div>
<div class="sect2">
<h3 id="_user_story_vocabulary"><a class="anchor" href="#_user_story_vocabulary"></a>1.1. User story vocabulary</h3>
<div class="paragraph">
<p>The following table contains the vocabulary of PolyCode. He is used to describe the user stories in the next section.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Guest</dt>
<dd>
<p>Someone who doesn&#8217;t have a PolyCode account.</p>
</dd>
<dt class="hdlist1">User</dt>
<dd>
<p>Someone who has a PolyCode account.</p>
</dd>
<dt class="hdlist1">Module</dt>
<dd>
<p>A coherent set of module and contents, organized in a tree structure. A module can be a challenge, a practice, a certification, a submodule, a test, etc.</p>
</dd>
<dt class="hdlist1">Content</dt>
<dd>
<p>A coherent set of components, organized in a tree structure. It&#8217;s a branch of the tree that are the modules. A content can be an exercice, a lesson, a question, etc.</p>
</dd>
<dt class="hdlist1">Component</dt>
<dd>
<p>A coherent set of components, organized in a tree structure. It&#8217;s a branch or a leave of another branch that are the contents or the components. A component can be an code editor, a quizz, a markdown, a mcq, a container, etc.</p>
</dd>
<dt class="hdlist1">Test</dt>
<dd>
<p>A type of module. He is made to evaluate users. It has a grade, which is the average of the grades of all contents of the test.</p>
</dd>
<dt class="hdlist1">Assessment</dt>
<dd>
<p>A section of PolyCode made to evaluate users, by passing tests.</p>
</dd>
<dt class="hdlist1">Campaign</dt>
<dd>
<p>The realization of an assessment in a set of users.</p>
</dd>
<dt class="hdlist1">Candidate</dt>
<dd>
<p>Someone who is invited to participate to a campaign. Became an user if he accepts the invitation.</p>
</dd>
<dt class="hdlist1">Assessment creator</dt>
<dd>
<p>A user who can create an test or an assessment, then invite someone to participate to it, as a candidate.</p>
</dd>
<dt class="hdlist1">Practice creator</dt>
<dd>
<p>A user who can manage his modules.</p>
</dd>
<dt class="hdlist1">Submitable</dt>
<dd>
<p>A component that can be submitted by the user. It can be a code editor, a quizz, a mcq, etc.</p>
</dd>
<dt class="hdlist1">Validator</dt>
<dd>
<p>The excepted response to a submitable.</p>
</dd>
<dt class="hdlist1">Submission</dt>
<dd>
<p>A user answer to a submitable. It is verified by a set of validators.</p>
</dd>
<dt class="hdlist1">Tag</dt>
<dd>
<p>A keyword that can be associated to a content, a candidate, etc.</p>
</dd>
<dt class="hdlist1">Item</dt>
<dd>
<p>A purchasable object. It can be a hint, a validator, etc.</p>
</dd>
<dt class="hdlist1">Purchase</dt>
<dd>
<p>The action of buying an item.</p>
</dd>
<dt class="hdlist1">Hint</dt>
<dd>
<p>A type of item that gives a clue to the user to solve a component. It is bought with polypoints.</p>
</dd>
<dt class="hdlist1">Polypoints</dt>
<dd>
<p>A virtual money responsible of the gamification of PolyCode. It can be used to buy items, like hints. It also used to rank users. The polypoints are collected by the users by passing modules and contents.</p>
</dd>
<dt class="hdlist1">Team</dt>
<dd>
<p>A group of users. The team polypoints are the sum of the polypoints of all users of the team, and is used to rank the teams.</p>
</dd>
<dt class="hdlist1">Captain</dt>
<dd>
<p>A user who can manage his team.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_user_stories"><a class="anchor" href="#_user_stories"></a>1.2. User stories</h3>
<div class="paragraph">
<p>The following tables contains the most of the user stories of PolyCode. It is not exhaustive, but it contains the most important user stories.
She is organized by functional quarters.</p>
</div>
<h4 id="_account" class="discrete">Account</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">As</th>
<th class="tableblock halign-center valign-middle">I want</th>
<th class="tableblock halign-center valign-middle">So that</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Guest</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Create my account</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Connect to my account</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Show my account details</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">See my user information, like my email or my account settings</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Update my account details</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Edit my user information, like my email or my account settings</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Delete my account</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Delete my user information</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Connect to my account with my email and my password</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Use the PolyCode features</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Logout from my account</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Remove my session and come back as a guest</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Reset my password</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Edit my credentials</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Show an account profile</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Get some information about a user (pseudo, rank, etc)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Show the ranking of the users</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Compare my rank with other users</p></td>
</tr>
</tbody>
</table>
<h4 id="_team" class="discrete">Team</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">As</th>
<th class="tableblock halign-center valign-middle">I want</th>
<th class="tableblock halign-center valign-middle">So that</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Create a new team</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Become a captain of a team</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Show my team details</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">See my team information, like the name or the description</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Captain</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Update my team details</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Edit my team information</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Captain</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Delete my team</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Dissolve my team</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Captain</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Invite other users in my team</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Grow my team and make it more active</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Captain</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Kick a member from my team</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Remove a member who is not active anymore or who is not a good fit for my team</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Accept an invitation to join a team</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Join a team</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Reject an invitation to join a team</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Don&#8217;t join a team</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Leave a team</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">No longer be a member of a team</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Captain</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Give the captain role to another member of my team</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Promote a member of my team who is more active than me</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Show a team profile</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Get some information about a team (name, rank, etc)</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Show the ranking of the teams</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Compare my team with other teams</p></td>
</tr>
</tbody>
</table>
<h4 id="_practice" class="discrete">Practice</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">As</th>
<th class="tableblock halign-center valign-middle">I want</th>
<th class="tableblock halign-center valign-middle">So that</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Content creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Create a content with some components</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Provide a way to learn or practice a specific notion or a specific language</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Content creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Edit one of my contents</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Update my content information</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Content creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Delete one of my contents</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Remove my content that is not useful anymore</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Content creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Create a module</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Organize contents by notion or by language</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Content creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Edit one of my modules</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Update my module information</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Content creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Delete one of my modules</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Remove my module that is not useful anymore</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Content creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Add a sub-module to one of my modules</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Aggregate modules into my module</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Content creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Add a content to one of my modules or sub-modules</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Aggregate contents into my module or my sub-module</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Show module list</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Choose a module to do</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Show the description of a module</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Take information about the module</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Show content list</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Choose an content to do</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Show the description of a content</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Take information about the content</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Show new modules and contents</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Find modules that I never did</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Add files to the code editor</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Write my code solution in multiple files</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Remove files from the code editor</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Remove files that I don&#8217;t need anymore</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Follow my progression in modules and contents</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Know how much I have done</p></td>
</tr>
</tbody>
</table>
<h4 id="_assessment" class="discrete">Assessment</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">As</th>
<th class="tableblock halign-center valign-middle">I want</th>
<th class="tableblock halign-center valign-middle">So that</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Create a test</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Create an exam to test candidate&#8217;s knowledge</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Edit one of my tests</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Update my test information</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Delete one of my tests</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Remove my test that is not useful anymore</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Set a time limit of my tests</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Candidates have to conclude the test in a limited time</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Set a time limit for each question of a test</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Candidates have to answer to a question in a limited time</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Set an amount of points for each question of a test</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Candidates cumulate points through the test</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Create a campaign</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Evaluate a group of candidates</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Edit one of my campaigns</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Update my campaign information</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Delete one of my campaigns</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Remove a campaign that is not useful anymore</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Set a start date for one of my campaigns</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Start automatically my campaign at a specific date, candidates can then start the test</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Add candidates to one of my campaigns by web interface</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Make candidates participate to my campaign</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Add candidates to one of my campaigns by csv file</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Make candidates participate to my campaign</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Add candidates to one of my campaigns by api call</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Make candidates participate to my campaign</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Remove candidates from one of my campaigns by web interface</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Remove candidates from my campaign</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Remove candidates from one of my campaigns by csv file</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Remove candidates from my campaign</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Remove candidates from one of my campaigns by api call</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Remove candidates from my campaign</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Add tags to candidates in one of my campaigns</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Organize candidates of my campaign in groups</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Candidate</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Accept a campaign invitation</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Participate in a campaign</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Candidate</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Decline a campaign invitation</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Do not participate in a campaign</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Show test list</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Choose a test to do</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Show the description of a test</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Take information about the test</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Start a test of a campaign of which I am a candidate</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Participate in a campaign</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Candidate</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Come back to a test of a campaign that I didn&#8217;t finish</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Finish a test that I didn&#8217;t finish before</p></td>
</tr>
</tbody>
</table>
<h4 id="_submission" class="discrete">Submission</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">As</th>
<th class="tableblock halign-center valign-middle">I want</th>
<th class="tableblock halign-center valign-middle">So that</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Submit a solution to a submitable</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Complete a content then earn polypoints, or complete a test</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">For a code editor, submit a solution for a specific validator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Check if my solution is correct for this validator</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Show the last submissions of a submitable who passed all validators</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Improve my old solution and submit it again</p></td>
</tr>
</tbody>
</table>
<h4 id="_stats" class="discrete">Stats</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">As</th>
<th class="tableblock halign-center valign-middle">I want</th>
<th class="tableblock halign-center valign-middle">So that</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">See the results of one of my campaigns in raw data</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Analyze the results of my campaign to have a first overview</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">See the results of one of my campaigns in raw data in a chart</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Analyze the results of my campaign in a more visual way</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Sort candidates in one of my campaigns (by tag, by score, by time, etc.)</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Find best candidates easily</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Export a general report of one of my campaign in a pdf</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Save the results of my campaign</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Export a detailed report of one of my campaign in a pdf</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Save the results of my campaign</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Export a detailed report of one of my campaign in a csv</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Save the results of my campaign and use it in a spreadsheet</p></td>
</tr>
</tbody>
</table>
<h4 id="_shop" class="discrete">Shop</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">As</th>
<th class="tableblock halign-center valign-middle">I want</th>
<th class="tableblock halign-center valign-middle">So that</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Buy hints for a submitable with polypoints</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Get some help to solve a submitable</p></td>
</tr>
</tbody>
</table>
<h4 id="_mailer" class="discrete">Mailer</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">As</th>
<th class="tableblock halign-center valign-middle">I want</th>
<th class="tableblock halign-center valign-middle">So that</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Receive a welcome email when I sign up</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Know that my account is created</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Receive an email to confirm my email address</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Verify that my email address is correct</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Receive an email when I&#8217;m invited in an team</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Get notified and get links to accept or decline the invitation</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Receive an email when I&#8217;m kicked out of a team</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Get notified when I&#8217;m removed from a team</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">User</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Receive an email when my team is dissolved</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Get notified when my team is deleted</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Candidate</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Receive an email when I&#8217;m invited in a campaign</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Get notified and get links to accept or decline the invitation</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Assessment creator</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Send again a campaign invitation email to a candidate</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Be sure that a candidate has received the invitation</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Candidate</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Receive an email when my participation in the test of a campaign is received</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Be sure that I have send my answers</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_polycode_microservices_architecture"><a class="anchor" href="#_polycode_microservices_architecture"></a>1.3. PolyCode microservices architecture</h3>
<div class="paragraph">
<p>Below is a proposed architecture for PolyCode microservices.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/01%20-%20Functional%20quarters/images/PolyCode%20microservice%20architecture%20schema.png" alt="PolyCode microservice architecture schema">
</div>
<div class="title">Figure 1. PolyCode microservice architecture schema</div>
</div>
<div class="paragraph">
<p>The main application will be detached into several microservices. This proposal is made of five microservices, themselves made of several modules. In the future, each microservice module may be detached into a new microservice.</p>
</div>
<div class="paragraph">
<p>For now, the five microservices are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Authentication</code> (Keycloak): This microservice will be used for all PolyCode users and services authentication.</p>
</li>
<li>
<p><code>Account</code>: This microservice will be used for all PolyCode users and services account management, including the user profile, the user preferences, the user teams, etc. It also used to manage the user&#8217;s transactions (shop). For now, this microservice will aslo do the authorization part, because it is already implemented.</p>
</li>
<li>
<p><code>Mailer</code>: This microservice will be used to send emails to users.</p>
</li>
<li>
<p><code>Learning</code>: This microservice will be used to manage the learning part of PolyCode, including the campaigns, the tests, the contents, the modules, the submitables, the validators, etc. It also used to get statistics about the assessments part.</p>
</li>
<li>
<p><code>Runner</code>: This microservice will be used to run the user&#8217;s code and return standard output and standard error.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In a first time, we will only detach the authentication microservice from the main application. The other microservices will be detached later.
The authorization part will be migrated to the authentication microservice in a second time.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authentication"><a class="anchor" href="#_authentication"></a>2. Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Authentication is the process of verifying the identity of a user or process. In this part, we will see the different authentication methods and how to implement them.</p>
</div>
<div class="sect2">
<h3 id="_oauth_2_0"><a class="anchor" href="#_oauth_2_0"></a>2.1. Oauth 2.0</h3>
<div class="paragraph">
<p>OAuth 2.0 is an framework that enables websites or applications to access resources from others web applications, without having to share the user&#8217;s credentials.</p>
</div>
<div class="paragraph">
<p>Clearly, it allows a user to grant limited access to their resources on one site, to another site, without having to expose their password.</p>
</div>
<div class="sect3">
<h4 id="_terminologies"><a class="anchor" href="#_terminologies"></a>2.1.1. Terminologies</h4>
<div class="paragraph">
<p>With Oauth 2.0, it&#8217;s important to understand the different terms. Here is a list of the most important of them :</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Protected resource</dt>
<dd>
<p>The data you want to access. For example, a user&#8217;s profile information.</p>
</dd>
<dt class="hdlist1">Resource server</dt>
<dd>
<p>The server hosting the protected resource. This is the API you want to access.</p>
</dd>
<dt class="hdlist1">Authorization server</dt>
<dd>
<p>The server that authenticates the user and issues access tokens after getting proper authorization. This is the server that you use to log in to your account.</p>
</dd>
<dt class="hdlist1">Client</dt>
<dd>
<p>The application that wants to access the protected resource. For example, a mobile app or a website.</p>
</dd>
<dt class="hdlist1">Resource owner</dt>
<dd>
<p>The user that owns the protected resource. When the resource owner is a person, it is referred to as an end-user.</p>
</dd>
<dt class="hdlist1">Redirect URI</dt>
<dd>
<p>The URI to which the authorization server will redirect the user after obtaining authorization.</p>
</dd>
<dt class="hdlist1">Response type</dt>
<dd>
<p>The type of the response used to get the authorization code. The authorization code is used to get the access token.</p>
</dd>
<dt class="hdlist1">Scope</dt>
<dd>
<p>The scope of the access request. This is a list of space-delimited, case-sensitive strings, defined by the authorization server.</p>
</dd>
<dt class="hdlist1">Consent</dt>
<dd>
<p>The small box that asks the user if they want to allow the client to access their protected resources.</p>
</dd>
<dt class="hdlist1">Client ID</dt>
<dd>
<p>The client identifier issued to the client during the registration process. This is the public identifier for the client.</p>
</dd>
<dt class="hdlist1">Client Secret</dt>
<dd>
<p>The client secret issued to the client during the registration process. This is the secret known only to the client and the authorization server.</p>
</dd>
<dt class="hdlist1">Authorization Code</dt>
<dd>
<p>The temporary code issued by the authorization server in exchange for the access token request.</p>
</dd>
<dt class="hdlist1">Access token</dt>
<dd>
<p>The token issued by the authorization server. The client uses the access token to access the protected resource.</p>
</dd>
<dt class="hdlist1">Access token</dt>
<dd>
<p>The token issued by the authorization server. The client uses the refresh token to get a new access token.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_flows"><a class="anchor" href="#_flows"></a>2.1.2. Flows</h4>
<div class="paragraph">
<p>There is mutliple flow to authenticate a user. Here is the most common ones, and his differences.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/Oauth%20flows%20comparaison.png" alt="Oauth flows comparaison">
</div>
<div class="title">Figure 2. Oauth flows comparaison</div>
</div>
<div class="sect4">
<h5 id="_authorization_code_flow"><a class="anchor" href="#_authorization_code_flow"></a>Authorization code flow</h5>
<div class="paragraph">
<p>The authorization code flow is the most secure one. It&#8217;s the one we will use in this project. Here is a diagram of this flow :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/Authorization%20code%20flow.png" alt="Authorization code flow">
</div>
<div class="title">Figure 3. Authorization code flow</div>
</div>
<div class="paragraph">
<p>Because this flow will be used in PolyCode, we will explain it in details. Here are the steps of this flow :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The user makes a request to the client. In our case, it&#8217;s a login request.</p>
</li>
<li>
<p>The client request the authorization server to get an authorization code.</p>
</li>
<li>
<p>The authorization server redirect the user to a authentication and consent page</p>
</li>
<li>
<p>The user authenticate and grant the requested scope.</p>
</li>
<li>
<p>The authorization server redirect the user to the client, with the authorization code.</p>
</li>
<li>
<p>The client send the authorization code, with the client ID and the client secret, to the authorization server.</p>
</li>
<li>
<p>The authorization server validate the client ID and the client secret.</p>
</li>
<li>
<p>The authorization server send back the access token and the refresh token (and a ID token if the scope contains openid).</p>
</li>
<li>
<p>The client can now use the access token to access the protected resource in the resource server.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_implicit_flow"><a class="anchor" href="#_implicit_flow"></a>Implicit flow</h5>
<div class="paragraph">
<p>The implicit flow is the most simple one. In this flow, the authorization server return directly the token. This method is not secure and should not be used in production. Here is a diagram of this flow :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/Implicit%20flow.png" alt="Implicit flow">
</div>
<div class="title">Figure 4. Implicit flow</div>
</div>
</div>
<div class="sect4">
<h5 id="_hybrid_flow"><a class="anchor" href="#_hybrid_flow"></a>Hybrid flow</h5>
<div class="paragraph">
<p>The hybrid flow is the same as authorization code flow, but there is a token server that deliver the token, after authentication by the authorization server. Here is a diagram that explain the request path :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/Hybrid%20flow.png" alt="Hybrid flow">
</div>
<div class="title">Figure 5. Hybrid flow</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_scope"><a class="anchor" href="#_scope"></a>2.1.3. Scope</h4>
<div class="paragraph">
<p>A access token permits to access to a protected resource. But, it&#8217;s not enough to access to all the resources. The authorization server can restrict the access, depending on the scope of the access token.</p>
</div>
<div class="paragraph">
<p>The score are asked by the client, in the query. Once the user is authenticated, the authorization server ask the user if he want to grant the requested scope, by displaying a consent page. If the user accept, the authorization server return the access token, with the requested scope.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jwt"><a class="anchor" href="#_jwt"></a>2.2. JWT</h3>
<div class="paragraph">
<p>JWT (JSON Web Token) is an open standard that define a compact and URL-safe way to represent claims to be transferred between two parties. The claims in a JWT are encoded as a JSON object. He have a header, a payload and a signature. He also have a expiration date.</p>
</div>
<div class="paragraph">
<p>The JWT is used for the authentication in OpenID Connect. His integrity is verified by the signature, then no one can modify the data.</p>
</div>
<div class="sect3">
<h4 id="_anatomy"><a class="anchor" href="#_anatomy"></a>2.2.1. Anatomy</h4>
<div class="paragraph">
<p>Here is an explaination of the JWT parts :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/JWT%20decomposition.png" alt="JWT decomposition">
</div>
<div class="title">Figure 6. JWT decomposition</div>
</div>
</div>
<div class="sect3">
<h4 id="_claims"><a class="anchor" href="#_claims"></a>2.2.2. Claims</h4>
<div class="paragraph">
<p>The payload of a JWT contains claims. Claims are statements about an entity (typically, a user) and additional metadata.</p>
</div>
<div class="paragraph">
<p>There are three types of claims :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Registered claims</code>: These are a set of predefined claims which are not mandatory but recommended. Some of them are : iss (issuer), sub (subject), aud (audience), exp (expiration time), nbf (not before), iat (issued at), and jti (JWT ID).</p>
</li>
<li>
<p><code>Public claims</code>: These can be defined at will by those using JWTs. This can be used to share information between parties that agree on using the same claim names.</p>
</li>
<li>
<p><code>Private claims</code>: These are the custom claims created to share information between parties that agree on using them and are neither registered or public claims.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is an payload of an basic ID token used in OpenID Connect, with the definition of each claims :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/ID%20token%20payload.png" alt="ID token payload">
</div>
<div class="title">Figure 7. ID token payload</div>
</div>
</div>
<div class="sect3">
<h4 id="_refresh_token"><a class="anchor" href="#_refresh_token"></a>2.2.3. Refresh token</h4>
<div class="paragraph">
<p>Once the user is authenticated, the authorization server return an access token, valid for a certain amount of time. Once this token expires, the client can ask for a new one, using the refresh token. Here is a diagram of the flow to get a new token :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/Refresh%20and%20access%20token.png" alt="Refresh and access token">
</div>
<div class="title">Figure 8. Refresh and access token</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_pkce"><a class="anchor" href="#_pkce"></a>2.3. PKCE</h3>
<div class="paragraph">
<p>PKCE (Proof Key for Code Exchange) is an extension of Oauth 2.0. It&#8217;s a security feature that prevents an attacker from stealing the authorization code.</p>
</div>
<div class="sect3">
<h4 id="_terminologies_2"><a class="anchor" href="#_terminologies_2"></a>2.3.1. Terminologies</h4>
<div class="paragraph">
<p>Here is the terminologies used in PKCE :</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Code Verifier</dt>
<dd>
<p>A huge random string (43 to 128 chars) generated by the client. It&#8217;s used to generate the code challenge, and is not sent to the authorization server.</p>
</dd>
<dt class="hdlist1">Code challenge</dt>
<dd>
<p>A base 64 encoded string of the code verifier. It&#8217;s sent to the authorization server.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_flow"><a class="anchor" href="#_flow"></a>2.3.2. Flow</h4>
<div class="paragraph">
<p>When the client send the authorization request to the authorization server, he also send the code challenge and the code challenge method (but not the code verifier).</p>
</div>
<div class="paragraph">
<p>Then, when the client send back the authorization code to the authorization server, he also send the code verifier. The authorization server then hash the code verifier and compare it to the code challenge. If they match, the authorization server send back the access token. Here is a diagram of this flow :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/Authorization%20code%20flow%20with%20PKCE.png" alt="Authorization code flow with PKCE">
</div>
<div class="title">Figure 9. Authorization code flow with PKCE</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_oauth_2_1"><a class="anchor" href="#_oauth_2_1"></a>2.4. Oauth 2.1</h3>
<div class="paragraph">
<p>Oauth 2.1 is not a new protocol, but a reference document. It&#8217;s a consolidation of best practices in Oauth 2.0. Here is the differences between Oauth 2.0 and Oauth 2.1 :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PKCE (Proof Key for Code Exchange) is mandatory.</p>
</li>
<li>
<p>Redirect URI must be compared using exact string matching.</p>
</li>
<li>
<p>Implicit flow is not allowed.</p>
</li>
<li>
<p>Resource owner password credentials grant flow is not allowed (because with this flow, the client can access to the user&#8217;s password).</p>
</li>
<li>
<p>Bearer token usage requires the use of the HTTP Authorization header field instead of the query parameter.</p>
</li>
<li>
<p>Refresh tokens must be bound to the client that requested them, or be one-time use.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_sso"><a class="anchor" href="#_sso"></a>2.5. SSO</h3>
<div class="paragraph">
<p>SSO (Single Sign On) is a protocol that allows a user to authenticate once to access multiple applications. With this property, a user logs in with a single ID and password to gain access to a connected system. The user is then signed in to all other systems that are part of the SSO infrastructure. This is in contrast to having to log in separately to each system.</p>
</div>
<div class="paragraph">
<p>An example of SSO is a student logging in to a university&#8217;s portal to access email, course registration, and other services.</p>
</div>
</div>
<div class="sect2">
<h3 id="_openid_connect"><a class="anchor" href="#_openid_connect"></a>2.6. OpenID Connect</h3>
<div class="paragraph">
<p>OpenID Connect (OIDC) is an authentication layer on top of Oauth 2.0. It&#8217;s a protocol that allows clients to verify the identity of the end-user based on the authentication performed by an authorization server, as well as to obtain basic profile information about the end-user in an interoperable and REST-like manner.</p>
</div>
<div class="sect3">
<h4 id="_oidc_scopes"><a class="anchor" href="#_oidc_scopes"></a>2.6.1. OIDC scopes</h4>
<div class="paragraph">
<p>There is multiple scopes in OIDC. Let&#8217;s see the most common ones :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/OIDC%20scopes.png" alt="OIDC scopes">
</div>
<div class="title">Figure 10. OIDC scopes</div>
</div>
</div>
<div class="sect3">
<h4 id="_endpoints"><a class="anchor" href="#_endpoints"></a>2.6.2. Endpoints</h4>
<div class="paragraph">
<p>Here is the endpoints defines in OIDC :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/OIDC%20endpoints.png" alt="OIDC endpoints">
</div>
<div class="title">Figure 11. OIDC endpoints</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ldap"><a class="anchor" href="#_ldap"></a>2.7. LDAP</h3>
<div class="paragraph">
<p>LDAP (Lightweight Directory Access Protocol) is a protocol that allows to access to a directory service. It&#8217;s a client-server protocol, and the client can be a user or an application.</p>
</div>
<div class="paragraph">
<p>In the case of PolyCode, we will use the polytech LDAP server to manage the users and groups of our applications. In this way, any guest who has an account on the Polytech network can access to polycode without creating a new account.</p>
</div>
</div>
<div class="sect2">
<h3 id="_tools"><a class="anchor" href="#_tools"></a>2.8. Tools</h3>
<div class="paragraph">
<p>There is multiple tools to help you to implement Oauth 2.0 and OpenID Connect in your application. This part will explain the most common ones and how to use them.</p>
</div>
<div class="sect3">
<h4 id="_keycloak"><a class="anchor" href="#_keycloak"></a>2.8.1. KeyCloak</h4>
<div class="paragraph">
<p>KeyCloak is an open source identity and access management solution. It&#8217;s a single sign-on solution that allows you to manage users, applications, roles, groups, etc. It&#8217;s an Oauth 2.0, OpenID Connect and SAML 2.0 compliant solution.</p>
</div>
<div class="paragraph">
<p>With the graphical interface, you can manage easily and quickly your resources. It supports multiple factors authentication and social login, all with a lot of adapters to integrate it in your application.</p>
</div>
<div class="paragraph">
<p>Here is an image of the keycloak architecture :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/Keycloak%20architecture.png" alt="Keycloak architecture">
</div>
<div class="title">Figure 12. Keycloak architecture</div>
</div>
<div class="paragraph">
<p>In the case of PolyCode, we will use KeyCloak to manage the authentication and authorization of our users and services.</p>
</div>
</div>
<div class="sect3">
<h4 id="_others_solutions"><a class="anchor" href="#_others_solutions"></a>2.8.2. Others solutions</h4>
<div class="paragraph">
<p>There is multiple other solutions to manage the authentication and authorization of your users and services. Because we will use KeyCloak for PolyCode, we have detailed it in the previous section.</p>
</div>
<div class="paragraph">
<p>Here is a list of other possible solutions :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Okta</code> (Cloud service)</p>
</li>
<li>
<p><code>Auth0</code> (Cloud service)</p>
</li>
<li>
<p><code>FusionAuth</code> (Open source solution)</p>
</li>
<li>
<p><code>AWS Cognito</code> (Cloud service)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_polycode_authentication_migration"><a class="anchor" href="#_polycode_authentication_migration"></a>2.9. PolyCode authentication migration</h3>
<div class="paragraph">
<p>For now, we use an Oauth2 system, with our own implementation. We will migrate this to KeyCloak, to have a more robust and scalable solution. Note that we will not migrate the authorization part, because is not the purpose here.</p>
</div>
<div class="sect3">
<h4 id="_architecture"><a class="anchor" href="#_architecture"></a>2.9.1. Architecture</h4>
<div class="paragraph">
<p>Here is a diagram of the wanted architecture :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/PolyCode%20authentication%20architecture%20schema.png" alt="PolyCode authentication architecture schema">
</div>
<div class="title">Figure 13. PolyCode authentication architecture schema</div>
</div>
<div class="paragraph">
<p>The goal is to have a KeyCloak instance, with a client for each service. Each service will have a client secret, and will use it to authenticate to KeyCloak.</p>
</div>
<div class="paragraph">
<p>The user, when he wants to access to some resources, will be redirected to KeyCloak. He will authenticate with his credentials (or create new), and will be redirected back to the PolyCode UI with a code. The UI will then exchange this code with KeyCloak, and will get an access token. This token will be used to authenticate to PolyCode, verify by KeyCloak against the Polycode API, and will be used to access to the resources.</p>
</div>
<div class="paragraph">
<p>To do this, we will follow multiple steps. This document is based on the <a href="https://www.keycloak.org/getting-started/getting-started-docker">official KeyCloak documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_setup_keycloak"><a class="anchor" href="#_setup_keycloak"></a>2.9.2. Setup KeyCloak</h4>
<div class="paragraph">
<p>First, we need to setup a KeyCloak instance. You can use the docker image, or install it on your server. You can run a KeyCloak instance in dev mode with the following command :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">docker run -p 8080:8080 -e KEYCLOAK_ADMIN=admin -e KEYCLOAK_ADMIN_PASSWORD=admin quay.io/keycloak/keycloak:20.0.2 start-dev</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configure_keycloak"><a class="anchor" href="#_configure_keycloak"></a>2.9.3. Configure KeyCloak</h4>
<div class="paragraph">
<p>Once the KeyCloak instance is running, you can access it at <a href="http://localhost:8080" class="bare">localhost:8080</a> with the <code>admin</code>/<code>admin</code> credentials if you used the command above.</p>
</div>
<div class="paragraph">
<p>Once logged in, you can create a new realm. A realm is a group of users, applications, and clients. You can create multiple realms in KeyCloak, and each realm is isolated from the others. For PolyCode, we will create a <code>polycode</code> realm.</p>
</div>
</div>
<div class="sect3">
<h4 id="_keycloak_clients"><a class="anchor" href="#_keycloak_clients"></a>2.9.4. KeyCloak clients</h4>
<div class="paragraph">
<p>A client is an application that wants to use KeyCloak to authenticate users. You can create multiple clients in a realm. For PolyCode, we will create two clients :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>polycode</code>: The client for the PolyCode application frontend.</p>
</li>
<li>
<p><code>polycode-api</code>: The client for the PolyCode API.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each client have multiple settings :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Client ID</code>: The unique identifier of the client.</p>
</li>
<li>
<p><code>Client Protocol</code>: The protocol used by the client. We will use <code>openid-connect</code>.</p>
</li>
<li>
<p><code>Valid Redirect URIs</code>: The list of valid redirect URIs for the client. For the <code>polycode</code> client, we will use <code>&lt;frontend_url&gt;/auth/callback</code>. For the <code>polycode-api</code> client, we will use <code>&lt;api_url&gt;/auth/callback</code>.</p>
</li>
<li>
<p><code>Web Origins</code>: The list of valid web origins for the client. For now, we will use <code>*</code> to allow all origins.</p>
</li>
<li>
<p><code>Credentials</code>: The credentials used by the client to authenticate to KeyCloak. You can find this in the <code>Credentials</code> tab.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For better security, you can also uncheck the <code>Implicit Flow</code> option.</p>
</div>
</div>
<div class="sect3">
<h4 id="_keycloak_users"><a class="anchor" href="#_keycloak_users"></a>2.9.5. KeyCloak users</h4>
<div class="paragraph">
<p>In our case, we don&#8217;t need to configure users, roles, groups, etc. because authorization will be managed by the API.</p>
</div>
</div>
<div class="sect3">
<h4 id="_polycode_integration_poc"><a class="anchor" href="#_polycode_integration_poc"></a>2.9.6. PolyCode integration - POC</h4>
<div class="paragraph">
<p>Now, we need to integrate KeyCloak in PolyCode. We will explain how to do this with a POC. Here is the project links :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://gitlab.polytech.umontpellier.fr/alexis.bernard01/poc-frontend-keycloack">Polycode-keycloak</a></p>
</li>
<li>
<p><a href="https://gitlab.polytech.umontpellier.fr/alexis.bernard01/poc-backend-keycloack">Polycode-keycloak-api</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To run the POC, you need first to run the backend, then the frontend, and finally the runner. The backend contains already a KeyCloak instance (not configured).</p>
</div>
<div class="paragraph">
<p>Then, you can access the polycode-keycloak application at <a href="http://localhost:3001" class="bare">localhost:3001</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_deployments"><a class="anchor" href="#_deployments"></a>2.9.7. Deployments</h4>
<div class="paragraph">
<p>Here is the deployment diagram of the future PolyCode authentication architecture :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/PolyCode%20authentication%20deployment%20schema.png" alt="PolyCode authentication deployment schema">
</div>
<div class="title">Figure 14. PolyCode authentication deployment schema</div>
</div>
<div class="paragraph">
<p>All communications between those services are in HTTP, and are secured with TLS.</p>
</div>
</div>
<div class="sect3">
<h4 id="_sequence_diagrams"><a class="anchor" href="#_sequence_diagrams"></a>2.9.8. Sequence diagrams</h4>
<div class="paragraph">
<p>Here is some sequence diagrams to explain the differences between the authentication process modes.</p>
</div>
<div class="sect4">
<h5 id="_vanilla_user_account_creation"><a class="anchor" href="#_vanilla_user_account_creation"></a>Vanilla user account creation</h5>
<div class="paragraph">
<p>Here is the sequence diagram of the user account creation :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/PolyCode%20authentication%20sequence%20diagram%20-%20Vanilla%20user%20account%20creation.png" alt="PolyCode authentication sequence diagram   Vanilla user account creation">
</div>
<div class="title">Figure 15. PolyCode authentication sequence diagram - Vanilla user account creation</div>
</div>
</div>
<div class="sect4">
<h5 id="_user_account_creation_via_polytech_ldap"><a class="anchor" href="#_user_account_creation_via_polytech_ldap"></a>User account creation via polytech LDAP</h5>
<div class="paragraph">
<p>Here is the sequence diagram of the user account creation via polytech LDAP :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/PolyCode%20authentication%20sequence%20diagram%20-%20Polytech%20LDAP%20account%20creation.png" alt="PolyCode authentication sequence diagram   Polytech LDAP account creation">
</div>
<div class="title">Figure 16. PolyCode authentication sequence diagram - Polytech LDAP account creation</div>
</div>
</div>
<div class="sect4">
<h5 id="_user_account_creation_via_google"><a class="anchor" href="#_user_account_creation_via_google"></a>User account creation via google</h5>
<div class="paragraph">
<p>Here is the sequence diagram of the user account creation via google :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/PolyCode%20authentication%20sequence%20diagram%20-%20Google%20identity%20provider%20user%20account%20creation.png" alt="PolyCode authentication sequence diagram   Google identity provider user account creation">
</div>
<div class="title">Figure 17. PolyCode authentication sequence diagram - Google identity provider user account creation</div>
</div>
</div>
<div class="sect4">
<h5 id="_vanilla_user_authentication"><a class="anchor" href="#_vanilla_user_authentication"></a>Vanilla user authentication</h5>
<div class="paragraph">
<p>Here is the sequence diagram of the user authentication :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/PolyCode%20authentication%20sequence%20diagram%20-%20Vanilla%20user%20authentication.png" alt="PolyCode authentication sequence diagram   Vanilla user authentication">
</div>
<div class="title">Figure 18. PolyCode authentication sequence diagram - Vanilla user authentication</div>
</div>
</div>
<div class="sect4">
<h5 id="_polytech_ldap_user_authentication"><a class="anchor" href="#_polytech_ldap_user_authentication"></a>Polytech LDAP user authentication</h5>
<div class="paragraph">
<p>Here is the sequence diagram of the Polytech LDAP user authentication :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/PolyCode%20authentication%20sequence%20diagram%20-%20Polytech%20LDAP%20user%20authentication.png" alt="PolyCode authentication sequence diagram   Polytech LDAP user authentication">
</div>
<div class="title">Figure 19. PolyCode authentication sequence diagram - Polytech LDAP user authentication</div>
</div>
</div>
<div class="sect4">
<h5 id="_user_authentication_via_google"><a class="anchor" href="#_user_authentication_via_google"></a>User authentication via google</h5>
<div class="paragraph">
<p>Here is the sequence diagram of the user authentication via google :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/02%20-%20Authentication/images/PolyCode%20authentication%20sequence%20diagram%20-%20Google%20identity%20provider%20user%20authentication.png" alt="PolyCode authentication sequence diagram   Google identity provider user authentication">
</div>
<div class="title">Figure 20. PolyCode authentication sequence diagram - Google identity provider user authentication</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inter_process_communication"><a class="anchor" href="#_inter_process_communication"></a>3. Inter-process communication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In a microservices application, the required load can grow or shrink according on the demand. This means that the number of instances of a service can change at any time. This is a problem because the instances of a service need to communicate with each other. This is where inter-process communication (IPC) comes in.</p>
</div>
<div class="paragraph">
<p>IPC refers to the mechanisms used by different processes to communicate with each other. Here, we approach this subject within the context of a microservice architecture application. This is important because microservices are typically designed to be independently deployable and scalable, which means they are often deployed on different machines or in different locations. This makes IPC a critical component of application architectures.</p>
</div>
<div class="sect2">
<h3 id="_methods"><a class="anchor" href="#_methods"></a>3.1. Methods</h3>
<div class="paragraph">
<p>There is a wide range of IPC mechanisms available, and each has its own advantages and disadvantages. Here, we will focus on the most popular ones, by category. We will also compare them in terms of their suitability for microservices architectures.</p>
</div>
<div class="sect3">
<h4 id="_synchonous_communication"><a class="anchor" href="#_synchonous_communication"></a>3.1.1. Synchonous communication</h4>
<div class="paragraph">
<p>Synchronous communication is a type of communication where the sender service waits for a response from the invoker service before continuing. There are two main mechanisms for synchronous communication: REST and RPC.</p>
</div>
<div class="sect4">
<h5 id="_rest"><a class="anchor" href="#_rest"></a>REST</h5>
<div class="paragraph">
<p>REST (Representational State Transfer) is a architectural style that defines a set of constraints to be used for creating Web services. RESTful Web services allow the requesting systems to access and manipulate textual representations of Web resources by using a uniform and predefined set of operations. RESTful Web services are stateless, which means that the server does not need to know anything about the state of the client that is making the request.</p>
</div>
<div class="paragraph">
<p>In the context of REST, a resource is a piece of data that can be accessed via a unique identifier, such as a URL. Resources are manipulated using a set of standard HTTP methods, such as GET, POST, PUT, and DELETE. These methods are used to retrieve, create, update, and delete resources, respectively.</p>
</div>
<div class="paragraph">
<p>REST APIs use HTTP as the communication protocol and can support a wide range of data formats, including JSON and XML. They are simple and lightweight, making them well-suited for use in microservices architectures.</p>
</div>
<div class="paragraph">
<p>Overall, REST is a widely used and well-established approach for building web services, and it is particularly well-suited for microservices because of its simplicity and flexibility.</p>
</div>
<div class="paragraph">
<p>Rest is guided by the 6 following principles:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Client-server</code>: The client and server are independent of each other. The two systems can be developed and deployed independently. A client should know only resource URIs, and that&#8217;s all.</p>
</li>
<li>
<p><code>Stateless</code>: The server does not store any client context between requests. Each request from the client to the server must contain all the information necessary to understand the request, and the server must respond to that request as new.</p>
</li>
<li>
<p><code>Cacheable</code>: The server must indicate if a response can be cached or not. If a response is cacheable, then a client or a server side cache can store it and reuse it later, saving bandwidth and server resources.</p>
</li>
<li>
<p><code>Uniform interface</code>: The interface between the client and the server must be uniform. This means that the interface should be simple and intuitive. The interface should be independent of the underlying implementation.</p>
</li>
<li>
<p><code>Layered system</code>: The client should not be aware of the underlying layers of the system. The client should only be aware of the immediate layer with which it is communicating. For example, a client cannot ordinarily tell whether it is connected directly to the end server or an intermediary along the way.</p>
</li>
<li>
<p><code>Code on demand</code> (optional): The server can optionally return executable code to the client. This code can be used to extend the functionality of the client.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_rpc"><a class="anchor" href="#_rpc"></a>RPC</h5>
<div class="paragraph">
<p>RPC (Remote Procedure Call) is a mechanism for a computer program to call and execute a procedure (subroutine) in another program, through the network. For a developer, the call is like a normal local procedure call, without any details for the remote interaction. The RPC mechanism make agnostic the developer about the language, the platform, the network, the operating system, etc.</p>
</div>
<div class="paragraph">
<p>RPC is used in microservices architecture applicaions to communicate between processes running on different computers over a network. As a procedure, RPC is a synchronous communication mechanism, which means that the sender service waits for a response from the invoker service before continuing.</p>
</div>
<div class="paragraph">
<p>gRPC is a modern, open source, high-performance remote procedure call (RPC) framework that can run in any environment. It can efficiently connect services with pluggable support for load balancing, tracing, health checking, and authentication.</p>
</div>
<div class="paragraph">
<p>By default, gRPC uses proto files to define services and messages. The following example shows a simple hello world service definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-proto" data-lang="proto">// The greeter service definition.
service Greeter {
  // Sends a greeting
  rpc SayHello (HelloRequest) returns (HelloReply) {}
}

// The request message containing the user's name.
message HelloRequest {
  string name = 1;
}

// The response message containing the greetings
message HelloReply {
  string message = 1;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_asynchronous_communication"><a class="anchor" href="#_asynchronous_communication"></a>3.1.2. Asynchronous communication</h4>
<div class="paragraph">
<p>Asynchronous communication is a type of communication where the sender service does not wait for a response from the invoker service before continuing. Let&#8217;s speak about the most popular mechanisms for asynchronous communication : Message queues and Publish-subscribe.</p>
</div>
<div class="sect4">
<h5 id="_message_queues"><a class="anchor" href="#_message_queues"></a>Message queues</h5>
<div class="paragraph">
<p>A message queue is a temporary storage area where messages are placed while waiting to be processed. Message queues are typically used to decouple the sender and receiver of a message, and to provide a buffer for the sender and receiver to handle the message. Here is a simple example of a message queue:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Message%20queue.png" alt="Message queue">
</div>
<div class="title">Figure 21. Message queue simple example</div>
</div>
<div class="paragraph">
<p>In this example, the sender service sends a message to the message queue, and the receiver service reads the message from the queue. The sender and receiver services do not need to be running at the same time, and they do not need to know anything about each other. This decoupling makes message queues well-suited for microservices architectures.</p>
</div>
<div class="paragraph">
<p>Message queues are typically implemented using a queueing system, such as RabbitMQ, Apache ActiveMQ, or IBM MQ. These systems are typically deployed as a separate service, and they can be used by multiple applications.</p>
</div>
</div>
<div class="sect4">
<h5 id="_publish_subscribe_pubsub"><a class="anchor" href="#_publish_subscribe_pubsub"></a>Publish-subscribe (pub/sub)</h5>
<div class="paragraph">
<p>Publish-subscribe is a messaging pattern where senders of messages, called publishers, do not program the messages to be sent directly to specific receivers, called subscribers. Instead, published messages are characterized into classes without knowledge of which subscribers, if any, there may be. Similarly, subscribers express interest in one or more classes and only receive messages that are of interest, without knowledge of which publishers, if any, there are. The message router, or message broker, is responsible for managing the information flow between publishers and subscribers.</p>
</div>
<div class="paragraph">
<p>The following diagram shows a simple example of a publish-subscribe system:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Publish-subscribe%20simple%20example.png" alt="Publish subscribe simple example">
</div>
<div class="title">Figure 22. Publish-subscribe simple example</div>
</div>
<div class="paragraph">
<p>In this example, the publisher service publishes a message to the message broker, and the subscriber service subscribes to the message broker. The publisher and subscriber services do not need to be running at the same time, and they do not need to know anything about each other. This decoupling makes publish-subscribe well-suited for microservices architectures.</p>
</div>
<div class="paragraph">
<p>Publish-subscribe is typically implemented using a message broker, who is responsible for storing messages and delivering them to subscribers., such as Apache Kafka, Google pub/sub, AWS SNS or Redis pub/sub. These systems are typically deployed as a separate service, and they can be used by multiple applications.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_architecture_patterns"><a class="anchor" href="#_architecture_patterns"></a>3.2. Architecture patterns</h3>
<div class="paragraph">
<p>In this section, we will see the most common patterns used to communicate between microservices.</p>
</div>
<div class="sect3">
<h4 id="_api_gateway"><a class="anchor" href="#_api_gateway"></a>3.2.1. API gateway</h4>
<div class="paragraph">
<p>An API gateway is a single entry point for clients to access the functionality of a distributed application. The API gateway is responsible for routing requests to the appropriate microservice, and for aggregating the results. It works as a reverse proxy, and it can be used to implement security, rate limiting load balancing and other functionality.</p>
</div>
<div class="paragraph">
<p>The following diagram shows a simple example of an API gateway:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/API%20gateway.png" alt="API gateway">
</div>
<div class="title">Figure 23. API gateway</div>
</div>
<div class="paragraph">
<p>In this example, the API gateway is responsible for routing requests to the appropriate microservice, and for aggregating the results.</p>
</div>
</div>
<div class="sect3">
<h4 id="_circuit_breaker"><a class="anchor" href="#_circuit_breaker"></a>3.2.2. Circuit breaker</h4>
<div class="paragraph">
<p>The circuit breaker pattern is a mechanism that allows a service to fail fast and recover quickly. It is used to prevent cascading failures in a distributed system. A circuit breaker is a state machine that can be in one of two states: closed or open. When the circuit breaker is closed, the service can be called. When the circuit breaker is open, the service cannot be called. The circuit breaker can be in the open state for a fixed amount of time, or it can be in the open state until a certain number of calls have been made.</p>
</div>
<div class="paragraph">
<p>The following diagram shows a simple example of a closed circuit breaker:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Closed%20circuit%20breaker.png" alt="Closed circuit breaker">
</div>
<div class="title">Figure 24. Closed circuit breaker</div>
</div>
<div class="paragraph">
<p>In this example, the circuit breaker is closed, and the service can be called. Until the service succeeds, the circuit breaker remains closed.</p>
</div>
<div class="paragraph">
<p>The following diagram shows a simple example of an open circuit breaker:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Open%20circuit%20breaker.png" alt="Open circuit breaker">
</div>
<div class="title">Figure 25. Open circuit breaker</div>
</div>
<div class="paragraph">
<p>In this example, the circuit breaker is open, and the service cannot be called. The circuit breaker will remain open for a fixed amount of time, or until a certain number of calls have been made. When the circuit breaker is open, the client receives an error message by the circuit breaker.</p>
</div>
</div>
<div class="sect3">
<h4 id="_bulkhead"><a class="anchor" href="#_bulkhead"></a>3.2.3. Bulkhead</h4>
<div class="paragraph">
<p>The bulkhead pattern is a mechanism that allows a service to limit the number of concurrent connections it can handle. It is used to prevent cascading failures in a distributed system. It applies when multiple applications needs to connect to a component by requesting a connection to that component.</p>
</div>
<div class="paragraph">
<p>The following diagram shows a simple example of the bulkhead pattern:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Bulkhead%20pattern.png" alt="Bulkhead pattern">
</div>
<div class="title">Figure 26. Bulkhead pattern</div>
</div>
<div class="paragraph">
<p>This pattern works as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A request for a wen connection is made.</p>
</li>
<li>
<p>The bulkhead will check is the connection to the requested component is availiable to serve the request.</p>
</li>
<li>
<p>If the connection is availiable, the bulkhead will serve the request.</p>
</li>
<li>
<p>If the connection is not availiable, the bulkhead will wait for a pre-defined time interval.</p>
</li>
<li>
<p>If any connection becomes availiable during this period, it will be allocated to serve the waiting request.</p>
</li>
<li>
<p>If no connection becomes availiable during this period, the bulkhead return an exception.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_sidecar"><a class="anchor" href="#_sidecar"></a>3.2.4. Sidecar</h4>
<div class="paragraph">
<p>The sidecar pattern is a mechanism that allows a service to add additional functionality to a microservice, such as logging, monitoring, or authentication. It is typically implemented as a separate process that runs alongside the microservice, such as a service proxy.</p>
</div>
<div class="paragraph">
<p>The following diagram shows a simple example of the sidecar pattern:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Sidecar%20pattern.png" alt="Sidecar pattern">
</div>
<div class="title">Figure 27. Sidecar pattern</div>
</div>
<div class="paragraph">
<p>With this pattern, each microservice is composed of two parts: the microservice and the sidecar. When a request is made from or to the microservice, the sidecar intercepts the request and adds additional functionality, then forwards the request. Let&#8217;s explain in detail how it works.</p>
</div>
<div class="paragraph">
<p>The following diagram shows the traffic flow when a request is made to the microservice, with a service proxy sidecar:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Sidecar%20pattern%20-%20request%20to%20microservice.png" alt="Sidecar pattern   request to microservice">
</div>
<div class="title">Figure 28. Sidecar pattern - request to microservice</div>
</div>
<div class="paragraph">
<p>When a request is made to the microservice, the service proxy intercepts the request (and can adds additional functionalities), then forwards the request to the microservice. The microservice processes the request, and returns the response to the service proxy (and can too adds additional functionalities), which forwards it to the client.</p>
</div>
</div>
<div class="sect3">
<h4 id="_service_mesh"><a class="anchor" href="#_service_mesh"></a>3.2.5. Service mesh</h4>
<div class="paragraph">
<p>A service mesh is a dedicated infrastructure layer for handling service-to-service communication. It works with a sidecar proxy that is deployed alongside each service. The sidecar proxy intercepts all network communication between microservices, and adds some functionnalities.</p>
</div>
<div class="paragraph">
<p>By this way, each microservice does not have to be coded with inter process communication logic, but only with the business logic. The service mesh is responsible for the inter process communication logic.</p>
</div>
<div class="paragraph">
<p>The most popular service mesh is Istio. It is an open source service mesh that provides traffic management, policy enforcement, and observability. Istio provide all following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Secure service-to-service communication in a cluster with TLS encryption</p>
</li>
<li>
<p>Strong identity-based authentication and authorization</p>
</li>
<li>
<p>Automatic load balancing for HTTP, gRPC, WebSocket, and TCP traffic</p>
</li>
<li>
<p>Fine-grained control of traffic behavior with rich routing rules, retries, failovers, and fault injection</p>
</li>
<li>
<p>A pluggable policy layer and configuration API supporting access controls, rate limits and quotas</p>
</li>
<li>
<p>Automatic metrics, logs, and traces for all traffic within a cluster, including cluster ingress and egress</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is a schema of the Istio service mesh, with the envoy proxy sidecar:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Istio%20service%20mesh.png" alt="Istio service mesh">
</div>
<div class="title">Figure 29. Istio service mesh</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_service_discovery"><a class="anchor" href="#_service_discovery"></a>3.3. Service discovery</h3>
<div class="paragraph">
<p>This part is principally based on the following article: <a href="https://www.nginx.com/blog/service-discovery-in-a-microservices-architecture/">Service Discovery in a Microservices Architecture</a></p>
</div>
<div class="paragraph">
<p>Service discovery is the process of automatically detecting the location of a service. It is used to allow a service to find other services without having to know their location. This problem appeared because in microservice architecture, the different services are deployed on different servers, and the location of a service can change over time because of server failures, autoscaling or load balancing.</p>
</div>
<div class="paragraph">
<p>Service discovery is typically implemented using a service registry, such as Consul, etcd, or ZooKeeper. These systems are typically deployed as a separate service, and they can be used by multiple applications.</p>
</div>
<div class="paragraph">
<p>There is two main types of discovery patterns: Client-side and Server-side. Before explain those patterns, let&#8217;s define what is a service registry.</p>
</div>
<div class="sect3">
<h4 id="_service_registry"><a class="anchor" href="#_service_registry"></a>3.3.1. Service registry</h4>
<div class="paragraph">
<p>A service registry is a key part of service discovery. It&#8217;s a database that contains the network location of all the services in a distributed system. He must be highly available. Some softwares implements this functionality, such as Consul, etcd, ZooKeeper, or Netflix Eureka.</p>
</div>
<div class="paragraph">
<p>Note that some systems such Kubernetes, Marathon and AWS have their own service registry implementation.</p>
</div>
<div class="paragraph">
<p>In those solutions, there are two common patterns for a service to register itself to the service registry: Self-registration and Third-party registration.</p>
</div>
<div class="sect4">
<h5 id="_self_registration"><a class="anchor" href="#_self_registration"></a>Self-registration</h5>
<div class="paragraph">
<p>In self-registration, the service is responsible for registering and deregistering in the services register and can send heartbeat if necessary. This pattern is the most simple one and is used in many systems.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Self-registration.png" alt="Self registration">
</div>
<div class="title">Figure 30. Self-registration</div>
</div>
<div class="paragraph">
<p>The real benefit of this pattern is its simplicity. You don&#8217;t need any other system component.</p>
</div>
</div>
<div class="sect4">
<h5 id="_third_party_registration"><a class="anchor" href="#_third_party_registration"></a>Third-party registration</h5>
<div class="paragraph">
<p>In third-party registration, a specific service is responsible to register all services in the service registry. This service is called a registrar. The registrar, implemented as a separate service, should be highly available.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Third-party%20registration.png" alt="Third party registration">
</div>
<div class="title">Figure 31. Third-party registration</div>
</div>
<div class="paragraph">
<p>The benefits of this pattern are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All services are decoupled from the service registry.</p>
</li>
<li>
<p>A service does not have to implement register logic.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The main drawback of this pattern is that it requires an additional service, the registrar.</p>
</div>
</div>
<div class="sect4">
<h5 id="_consul"><a class="anchor" href="#_consul"></a>Consul</h5>
<div class="paragraph">
<p>Let&#8217;s see how Consul implements the service registry.</p>
</div>
<div class="paragraph">
<p>Consul is a service networking that offers some features. Here, we will speak about the service discovery feature, that allows to register services and to query them, in a kubernetes cluster. It is a third-party registration.</p>
</div>
<div class="paragraph">
<p>Consul is made up of two parts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Consul server</code>: The consul server is made up of some server agents (a leader and some followers), that are responsible to store all services states. Consul follows the consensus protocol to ensure that all agents have the same state, and be fault tolerant.</p>
</li>
<li>
<p><code>Consul client node</code>: A consul client is made up of two parts: the consul client agent, that is responsible to register, deregister and query the services, and the proxy, that makes the bridge between the agent and the service. Generally, there is one consul client agent per consul client node. The consul client node can be a kubernetes node, or a VM.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The services does not need to know the location of the others services, and can query them using a domain name. The proxy is responsible to resolve the domain name to a service location, and to forward him the request.</p>
</div>
<div class="paragraph">
<p>Here is the schema of the service discovery with Consul:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Service%20discovery%20with%20Consul.png" alt="Service discovery with Consul">
</div>
<div class="title">Figure 32. Service discovery with Consul</div>
</div>
<div class="paragraph">
<p>It is the basic functioning of Consul. In a kubernetes cluster, the consul client agent is not necessary, because the kubelet can replace it.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Service%20discovery%20with%20Consul%20in%20a%20kubernetes%20cluster.png" alt="Service discovery with Consul in a kubernetes cluster">
</div>
<div class="title">Figure 33. Service discovery with Consul in a kubernetes cluster</div>
</div>
<div class="paragraph">
<p>In this schema, the consul server is deployed in a kubernetes cluster. The consul client agent is replaced a unique sidecar container, that is deployed in each pod. The sidecar container is responsible to register, deregister and query the services and is made up of two parts: a dataplane and a envoy proxy.</p>
</div>
<div class="paragraph">
<p>Consul uses the gossip protocol to share the services states between the client agents and the server agents. The gossip protocol is a peer-to-peer protocol, that means that each node is responsible to share the information with the others. Here is a schema of the gossip protocol:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Gossip%20protocol%20with%20consul.png" alt="Gossip protocol with consul">
</div>
<div class="title">Figure 34. Gossip protocol with consul</div>
</div>
<div class="paragraph">
<p>Every few seconds, each consul client agent and server will send a heartbeat to one of its peers, chosen randomly. By this way, the global state of the cluster is shared between all nodes of the cluster. This protocol is based on UDP, so it is very efficient, and it is fault tolerant. It is also very scalable, and reduces the load on the network bandwidth.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_client_side_discovery"><a class="anchor" href="#_client_side_discovery"></a>3.3.2. Client-side discovery</h4>
<div class="paragraph">
<p>In client-side discovery, the client is responsible for discovering the location of the other services by query the service registry.</p>
</div>
<div class="paragraph">
<p>The following diagram shows a simple example of client-side discovery:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Client-side%20discovery.png" alt="Client side discovery">
</div>
<div class="title">Figure 35. Client-side discovery</div>
</div>
<div class="paragraph">
<p>in this schema, each service, once started, will register itself to the service registry.</p>
</div>
<div class="paragraph">
<p>The client will then query periodically the service registry to get availiable locations of the services. If a service is no longer available, the service register will delete its list of available services, then after the next periodic updating of the customer, it will no longer try to connect to this service.</p>
</div>
</div>
<div class="sect3">
<h4 id="_server_side_discovery"><a class="anchor" href="#_server_side_discovery"></a>3.3.3. Server-side discovery</h4>
<div class="paragraph">
<p>In server-side discovery, the server (load balancer) is responsible for discovering the location of the other services by query the service registry. A load balancer is a server that distributes network or application traffic across a number of services.</p>
</div>
<div class="paragraph">
<p>The following diagram shows a simple example of server-side discovery:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Server-side%20discovery.png" alt="Server side discovery">
</div>
<div class="title">Figure 36. Server-side discovery</div>
</div>
<div class="paragraph">
<p>In this schema, as well for the client-side discovery, each service, once started, will register itself to the service registry.</p>
</div>
<div class="paragraph">
<p>The load balancer will then query the service registry periodically to get availiable locations of the services. If a service is no longer available, the service register will delete its list of available services, then after the next periodic updating of the load balancer, it will no longer try to connect to this service.</p>
</div>
<div class="paragraph">
<p>The server-side discovery has several benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All details of service discovery is abstracted for the client.</p>
</li>
<li>
<p>Client needs only to query one service, the load balancer, to query the required service.</p>
</li>
<li>
<p>This pattern is more scalable than the client-side discovery.</p>
</li>
<li>
<p>This pattern is easier to use because some softwares already implement this pattern (and for free), such as Nginx, HAProxy, Varnish, etc.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_polycode_integration"><a class="anchor" href="#_polycode_integration"></a>3.4. PolyCode integration</h3>
<div class="paragraph">
<p>For our application, PolyCode, we have different types of microservices. There is the microservice cutting scheme presented in part 1 of this document.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/PolyCode%20microservice%20architecture%20schema.png" alt="PolyCode microservice architecture schema">
</div>
<div class="title">Figure 37. PolyCode microservice architecture schema</div>
</div>
<div class="paragraph">
<p>The five microservices are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Mailer</code></p>
</li>
<li>
<p><code>Authentication</code> (Keycloak)</p>
</li>
<li>
<p><code>Account</code></p>
</li>
<li>
<p><code>Learning</code></p>
</li>
<li>
<p><code>Runner</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this part, we will see how we will manage the communication and the discovery between those microservices. Let&#8217;s begin with the mailer microservice.</p>
</div>
<div class="sect3">
<h4 id="_mailer_service_communication"><a class="anchor" href="#_mailer_service_communication"></a>3.4.1. Mailer service communication</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
In the case of this exercise, we can&#8217;t use a message queueing system, then we cannot consider the following proposition. In a real case, I think this is the best solution, that is why I present it here. You can skip this part if you want.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The mailer service is responsible to send emails to users or candidates. It is a service that is used by others. For example, when a user is invited in a team, the <code>Account</code> service will call the <code>Mailer</code> service to send the email.</p>
</div>
<div class="paragraph">
<p>This use case does not need a response from the <code>mailer</code>, because if a letter is not received, there is still a way to send it again. Especially since we would have no guarantee than the mail was well received and read.</p>
</div>
<div class="paragraph">
<p>Therefore, we will use asynchronous communication for this service. Since we only have this service that uses it, we will not use pub/sub pattern, but a simple queueing system.</p>
</div>
<div class="paragraph">
<p>In our previous example, the <code>Account</code> service will send a message to the event queue, and the <code>Mailer</code> service will consume this message, and send the email.</p>
</div>
<div class="paragraph">
<p>The benefits of this pattern are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>Account</code> service does not have to wait for the <code>Mailer</code> service to send the email.</p>
</li>
<li>
<p>The <code>Mailer</code> service can consume the messages in the queue at its own pace.</p>
</li>
<li>
<p>We can scale the <code>Mailer</code> service easily by adding multiple consumers, depending on the queue size.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The drawbacks of this pattern are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the scale is not well managed, the queue can grow indefinitely and cause some problems, and the mails will not be sent in a suitable time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The chosen the queueing system RabbitMQ. There is no particular reason for this choice, except that it is the most widely deployed open source message broker.</p>
</div>
<div class="paragraph">
<p>Here is the schema of the <code>Mailer</code> microservice communication with RabbitMQ message broker:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Mailer%20microservice%20communication.png" alt="Mailer microservice communication">
</div>
<div class="title">Figure 38. Mailer microservice communication</div>
</div>
</div>
<div class="sect3">
<h4 id="_others_services_communication"><a class="anchor" href="#_others_services_communication"></a>3.4.2. Others services communication</h4>
<div class="paragraph">
<p>For the other microservices, we will use synchronous communication. The reason is that we need a response from the service. For example, when a user query his profile data to the <code>Account</code> service, a call to the <code>Authentication</code> service is made to check token validity. In this case, we need a response before sending the data to the user.</p>
</div>
<div class="paragraph">
<p>For all our microservices, we will use a REST API. The reason is that it is a well-known pattern, and it is easy to use. We don&#8217;t need to use a more complex protocol such as gRPC, because we don&#8217;t need to optimize the communication between our microservices for now.</p>
</div>
</div>
<div class="sect3">
<h4 id="_service_discovery_2"><a class="anchor" href="#_service_discovery_2"></a>3.4.3. Service discovery</h4>
<div class="paragraph">
<p>For the service discovery, we will use the third-party registration pattern. We will use the <code>Consul</code> service registry. The reason is that it is a well-known service registry. We will use the self-managed version of Consul (open source) with kubernetes, because the PolyCode application is not deployed in a cloud environment, but on private servers, at Polytech.</p>
</div>
<div class="paragraph">
<p>Here is the schema of the PolyCode service discovery with Consul:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/PolyCode%20service%20discovery%20with%20Consul.png" alt="PolyCode service discovery with Consul">
</div>
<div class="title">Figure 39. PolyCode service discovery with Consul</div>
</div>
<div class="paragraph">
<p>In this schema, we can see that each microservice is deployed in a kubernetes pod. Each pod has the microservice and a sidecar container, that is responsible to register, deregister and query the service. The sidecar container is made up of two parts: the dataplane and an envoy proxy. The envoy proxy is responsible to communicate with the service, and make load-balacing, and the dataplane with the consul control plane. The consul control plane is responsible to keep the global state of the cluster.</p>
</div>
</div>
<div class="sect3">
<h4 id="_sequence_diagram_of_a_basic_request"><a class="anchor" href="#_sequence_diagram_of_a_basic_request"></a>3.4.4. Sequence diagram of a basic request</h4>
<div class="paragraph">
<p>Here is a sequence diagram of a basic request, from the <code>Account</code> service to the <code>Authentication</code> service, to verify the token validity:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/03%20-%20IPC/images/Sequence%20diagram%20of%20a%20basic%20PolyCode%20request.png" alt="Sequence diagram of a basic PolyCode request">
</div>
<div class="title">Figure 40. Sequence diagram of a basic PolyCode request</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_management"><a class="anchor" href="#_data_management"></a>4. Data Management</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The data management concerns the way the database is managed, and how the data is stored. In microservice architecture, the microservices are independent, and they don&#8217;t share the same database. Because of this, some new problems can appear and need to be solved. Let&#8217;s see them, then how to solve them. After that, we will see how the microservice migration affects the data organization.</p>
</div>
<div class="sect2">
<h3 id="_data_consistency"><a class="anchor" href="#_data_consistency"></a>4.1. Data Consistency</h3>
<div class="paragraph">
<p>In a traditional monolithic architecture, the data is stored in a single database, and it guarantees the data consistency by using transactions. In a microservice architecture, the data is stored in different databases, and it is not possible to use transactions. This means that the data consistency is not guaranteed.</p>
</div>
<div class="paragraph">
<p>Here is an example of a flow that cause a data inconsistency:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/04%20-%20Tracing/images/Inconsistent%20Data.png" alt="Inconsistent Data">
</div>
<div class="title">Figure 41. Inconsistent Data</div>
</div>
<div class="paragraph">
<p>This problem is the most complex problem to solve in a microservice architecture, and can cause a lot of problems, such as data loss, or data corruption.</p>
</div>
<div class="paragraph">
<p>There are several ways to solve it, such as the Saga pattern, or the Event Sourcing pattern, but they are not allowed in our case. We can limit the problem by following some rules, like validate the data editing only after the resonse of all others services, but we can&#8217;t solve it completely; A called service can edit data, and the caller service can fail before validating the data. This means that the data is not consistent between this two services.</p>
</div>
<div class="paragraph">
<p>The best we can do is manage data inconsistencies, which requires additional development.</p>
</div>
</div>
<div class="sect2">
<h3 id="_data_backup"><a class="anchor" href="#_data_backup"></a>4.2. Data Backup</h3>
<div class="paragraph">
<p>An important part of data management is to backup the data. It is necessary to ensure that it is not lost. As said before, in a microservice architecture, the data is stored in different databases, and it is not possible to backup all the data at the same time. This means that it is necessary to backup each database separately.</p>
</div>
<div class="paragraph">
<p>The backup can be done in several ways, such as a snapshot, or a dump. The snapshot is a copy of the database at a specific time, and the dump is a copy of the database at a specific time, but in a sql file. The snapshot is faster, but the dump is more portable.</p>
</div>
<div class="paragraph">
<p>The problem here is again data consistency. We need to ensure that the backup is made at the same time for all databases, to ensure that the data is consistent. This can be done by using a tool, such as <code>pg_dumpall</code>, which is a tool to dump all databases at the same time, but it is not possible is your databases are not on the same instance.</p>
</div>
</div>
<div class="sect2">
<h3 id="_polycode_data_migration"><a class="anchor" href="#_polycode_data_migration"></a>4.3. PolyCode Data Migration</h3>
<div class="paragraph">
<p>The PolyCode data organization changes is caused by the microservice migration. This new organization is more complex, and it requires more development.</p>
</div>
<div class="paragraph">
<p>Unfortunately, this refactoring has not been done yet.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tracing"><a class="anchor" href="#_tracing"></a>5. Tracing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tracing is the ability to follow the flow of a request at its different steps. It is useful to provide more observability, and to debug the application when a problem occurs.</p>
</div>
<div class="paragraph">
<p>In a monolithic architecture, all the requests are handled by the same application, then it is easy to trace them. You only need to implement a tracing or a log system, and to store it.</p>
</div>
<div class="paragraph">
<p>Nowadays, a microservice architecture, the requests are handled by different applications, and it is more difficult to trace them. You need to implement a tracing system in each application, and to send the traces to a central system to store them.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see how tracing works in a microservice architecture.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="_data_management_2"><a class="anchor" href="#_data_management_2"></a>6. Data Management</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The data management concerns the way the database is managed, and how the data is stored. In microservice architecture, the microservices are independent, and they don&#8217;t share the same database. Because of this, some new problems can appear and need to be solved. Let&#8217;s see them, then how to solve them. After that, we will see how the microservice migration affects the data organization.</p>
</div>
<div class="sect2">
<h3 id="_data_consistency_2"><a class="anchor" href="#_data_consistency_2"></a>6.1. Data Consistency</h3>
<div class="paragraph">
<p>In a traditional monolithic architecture, the data is stored in a single database, and it guarantees the data consistency by using transactions. In a microservice architecture, the data is stored in different databases, and it is not possible to use transactions. This means that the data consistency is not guaranteed.</p>
</div>
<div class="paragraph">
<p>Here is an example of a flow that cause a data inconsistency:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/07%20-%20Data%20management/images/Inconsistent%20Data.png" alt="Inconsistent Data">
</div>
<div class="title">Figure 42. Inconsistent Data</div>
</div>
<div class="paragraph">
<p>This problem is the most complex problem to solve in a microservice architecture, and can cause a lot of problems, such as data loss, or data corruption.</p>
</div>
<div class="paragraph">
<p>There are several ways to solve it, such as the Saga pattern, or the Event Sourcing pattern, but they are not allowed in our case. We can limit the problem by following some rules, like validate the data editing only after the resonse of all others services, but we can&#8217;t solve it completely; A called service can edit data, and the caller service can fail before validating the data. This means that the data is not consistent between this two services.</p>
</div>
<div class="paragraph">
<p>The best we can do is manage data inconsistencies, which requires additional development.</p>
</div>
</div>
<div class="sect2">
<h3 id="_data_backup_2"><a class="anchor" href="#_data_backup_2"></a>6.2. Data Backup</h3>
<div class="paragraph">
<p>An important part of data management is to backup the data. It is necessary to ensure that it is not lost. As said before, in a microservice architecture, the data is stored in different databases, and it is not possible to backup all the data at the same time. This means that it is necessary to backup each database separately.</p>
</div>
<div class="paragraph">
<p>The backup can be done in several ways, such as a snapshot, or a dump. The snapshot is a copy of the database at a specific time, and the dump is a copy of the database at a specific time, but in a sql file. The snapshot is faster, but the dump is more portable.</p>
</div>
<div class="paragraph">
<p>The problem here is again data consistency. We need to ensure that the backup is made at the same time for all databases, to ensure that the data is consistent. This can be done by using a tool, such as <code>pg_dumpall</code>, which is a tool to dump all databases at the same time, but it is not possible is your databases are not on the same instance.</p>
</div>
</div>
<div class="sect2">
<h3 id="_polycode_data_migration_2"><a class="anchor" href="#_polycode_data_migration_2"></a>6.3. PolyCode Data Migration</h3>
<div class="paragraph">
<p>The PolyCode data organization changes is caused by the microservice migration. This new organization is more complex, and it requires more development.</p>
</div>
<div class="paragraph">
<p>Unfortunately, this refactoring has not been done yet.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_security"><a class="anchor" href="#_security"></a>7. Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The security is a very important part in any software development, and that has always been.</p>
</div>
<div class="paragraph">
<p>In a microservice architecture, unlike a monolith, each service runs in its own process and may have its own unique security requirements. Additionally, because the services communicate with each other over the network, there is a greater risk of data breaches and other security incidents. Therefore, it is important to consider security as early as possible in the development process.</p>
</div>
<div class="paragraph">
<p>There is many ways to secure a microservice architecture, under several aspects. Here, we will try to cover the most important ones. You have to keep in mind that there is no ultimate solution, and you have to choose the right security solution for your specific needs.</p>
</div>
<div class="sect2">
<h3 id="_application_level"><a class="anchor" href="#_application_level"></a>7.1. Application level</h3>
<div class="paragraph">
<p>The application security level concerns the code itself, and the way it is written. It is important to write secure code, and to follow the best practices. It is necessary to start that a developer will write code containing security failures. We cannot prevent this, but we can limit it in several ways. Let&#8217;s see some of them.</p>
</div>
<div class="sect3">
<h4 id="_code_review"><a class="anchor" href="#_code_review"></a>7.1.1. Code Review</h4>
<div class="paragraph">
<p>The code review is a very important part of the development process. It is a way to ensure that the code is written in a secure way, and that it follows the best practices. It is also a way to ensure that the code is written in a way that is easy to maintain, and that it is easy to understand. It is always good to have another point of view on written code.</p>
</div>
<div class="paragraph">
<p>Examination of the code can be carried out by someone in the same company, or by external developers, with security audits.</p>
</div>
</div>
<div class="sect3">
<h4 id="_dependency_analysis"><a class="anchor" href="#_dependency_analysis"></a>7.1.2. Dependency Analysis</h4>
<div class="paragraph">
<p>Additionally, it is necessary to keep an eye on the dependencies used for the development of applications.
security failures are frequently discovered, and security updates are then necessary.</p>
</div>
<div class="paragraph">
<p>There are tools to detect it automatically, such as Dependabot (GitHub), or Snyk.</p>
</div>
</div>
<div class="sect3">
<h4 id="_security_testing"><a class="anchor" href="#_security_testing"></a>7.1.3. Security Testing</h4>
<div class="paragraph">
<p>Security testing is a way to ensure that the code written code works as expected. There are several ways to do it, and we will explain three of them.</p>
</div>
<div class="sect4">
<h5 id="_static_application_security_testing_sast"><a class="anchor" href="#_static_application_security_testing_sast"></a>Static application security testing (SAST)</h5>
<div class="paragraph">
<p>SAST is a way to analyze the code statically, without executing it (only with the source code). It is a way to detect security failures in the code, and to ensure that the code follows the best practices. There are several tools to do it, such as Klocwork, or Checkmarx.</p>
</div>
</div>
<div class="sect4">
<h5 id="_dynamic_application_security_testing_dast"><a class="anchor" href="#_dynamic_application_security_testing_dast"></a>Dynamic application security testing (DAST)</h5>
<div class="paragraph">
<p>DAST is a way to analyze the code dynamically, by executing it (without the source code). It is a way to detect security failures in the code, and to ensure that the code follows the best practices. Arachni, an open source tool, can be used for this purpose.</p>
</div>
<div class="paragraph">
<p>Here is a diagram showing where the SAST and DAST tests are done on the development process.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/09%20-%20Security/images/SAST%20and%20DAST%20tests%20in%20the%20development%20process.png" alt="SAST and DAST tests in the development process">
</div>
<div class="title">Figure 43. SAST and DAST tests in the development process</div>
</div>
</div>
<div class="sect4">
<h5 id="_stress_testing"><a class="anchor" href="#_stress_testing"></a>Stress Testing</h5>
<div class="paragraph">
<p>Stress testing is a way to test the code under heavy load. It is a way to ensure that the code can handle a large number of requests. There are several tools to do it, such as WebLoad, LoadNinja, or JMeter.</p>
</div>
<div class="paragraph">
<p>This type of testing is important, because there is no other way to test the resistance of an application against a huge load.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_communication_level"><a class="anchor" href="#_communication_level"></a>7.2. Communication level</h3>
<div class="paragraph">
<p>The communication level concerns the way the services communicate with each other. In a microservice architecture, each microservice communication is done through the network.</p>
</div>
<div class="paragraph">
<p>There are two types of communication in a microservice architecture: internal communication and external communication. Here is a diagram showing those two different types.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/09%20-%20Security/images/Internal%20and%20external%20communication%20in%20a%20microservice%20architecture.png" alt="Internal and external communication in a microservice architecture" width="70%">
</div>
<div class="title">Figure 44. Internal and external communication in a microservice architecture</div>
</div>
<div class="paragraph">
<p>External communication is the communication between a microservice and the web. If a microservice is exposed to the web, it is strongly likely that he was attacked. Therefore, it is necessary to ensure that the communication between the microservice and the web is encrypted.</p>
</div>
<div class="paragraph">
<p>Internal communication is the communication between microservices. This communication is not exposed to the web, but it is still better to ensure that it is encrypted, if possible.</p>
</div>
<div class="paragraph">
<p>Let us first see what layers we can encrypt communication.</p>
</div>
<div class="sect3">
<h4 id="_gateway_level"><a class="anchor" href="#_gateway_level"></a>7.2.1. Gateway level</h4>
<div class="paragraph">
<p>If you use a gateway, you can encrypt the communication between the gateway and the web. This is the most easy way to add encryption. You only have to add a TLS certificate to the gateway, then all the outgoing communication will be encrypted. Note that all internal communication will not be encrypted.</p>
</div>
<div class="paragraph">
<p>Here is a diagram showing the gateway level encryption:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/09%20-%20Security/images/Gateway%20level%20encryption.png" alt="Gateway level encryption" width="70%">
</div>
<div class="title">Figure 45. Gateway level encryption</div>
</div>
<div class="paragraph">
<p>Here, the gateway provide a TLS certificate to the web. The web will then be able to communicate with him in a secure way.</p>
</div>
</div>
<div class="sect3">
<h4 id="_sidecar_level"><a class="anchor" href="#_sidecar_level"></a>7.2.2. Sidecar level</h4>
<div class="paragraph">
<p>You can also encrypt the communication between each microservice and the gateway (or the web, if you donc have a gateway). This is a more complex way, but it is also the most secure one.</p>
</div>
<div class="paragraph">
<p>Here is a diagram showing the sidecar level encryption:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/09%20-%20Security/images/Sidecar%20level%20encryption.png" alt="Sidecar level encryption" width="70%">
</div>
<div class="title">Figure 46. Sidecar level encryption</div>
</div>
<div class="paragraph">
<p>Here, each microservice have a sidecar that provide a TLS certificate. With this approach, all communication is encrypted (internal and external). The only exception is the communication between the sidecar and the microservice, but this communication is not exposed to any other network.</p>
</div>
<div class="paragraph">
<p>It&#8217;s strongly recommended to use this approach, if possible.</p>
</div>
</div>
<div class="sect3">
<h4 id="_rate_limiting"><a class="anchor" href="#_rate_limiting"></a>7.2.3. Rate limiting</h4>
<div class="paragraph">
<p>Rate limiting is a way to limit the number of requests that can be sent to a microservice. It is a way to prevent a service from being overloaded, or to prevent a service from being attacked, such as a DDoS attack, or a brute force attack.</p>
</div>
<div class="paragraph">
<p>There are several ways to do it, such as the Nginx rate limiting module, or the Envoy rate limiting module.</p>
</div>
</div>
<div class="sect3">
<h4 id="_service_authentication_and_authorization"><a class="anchor" href="#_service_authentication_and_authorization"></a>7.2.4. Service Authentication and Authorization</h4>
<div class="paragraph">
<p>Service authentication and authorization is a way to ensure that only known and authorized services can communicate with each other.</p>
</div>
<div class="sect4">
<h5 id="_authentication_2"><a class="anchor" href="#_authentication_2"></a>Authentication</h5>
<div class="paragraph">
<p>Authentication is a way to ensure that the service is known. Here, we will see how to authenticate a service using OAuth 2.0.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can refer to the authentication part of this document to see more details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A service, such as a user, can authenticate himself to the authorization server, and get an access token to communicate with other services. In this case, it&#8217;s the Client Credentials Grant type that is used.</p>
</div>
<div class="paragraph">
<p>Here is a sequence diagram of this flow:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/09%20-%20Security/images/Client%20Credentials%20Flow.png" alt="Client Credentials Flow">
</div>
<div class="title">Figure 47. Client Credentials Flow</div>
</div>
<div class="paragraph">
<p>As you can see, this flow is very simple. Because the communication is encrypted, as explained in the previous section, the client secret is not exposed to the network.</p>
</div>
</div>
<div class="sect4">
<h5 id="_authorization"><a class="anchor" href="#_authorization"></a>Authorization</h5>
<div class="paragraph">
<p>Authorization is a way to ensure that a known service has sufficient rights to communicate with another service. To do so, we will use the role based access control (RBAC) model.</p>
</div>
<div class="paragraph">
<p>This model is based on roles and permissions. A role is a set of permissions, and is assigned to a subject (can be a user, or a service). A permission is an action associated with a resource. For example, a subject can be assigned to the role named <code>admin</code>, who own the permission <code>read</code> on the resource <code>user</code>. This means that this subject can read the resource <code>user</code>.</p>
</div>
<div class="paragraph">
<p>With this model, we can apply the principle of least privilege. This principle is a way to ensure that a subject can only do what he needs to do. It is better to have a problem of lack of permissions, and to have to add it, rather than an excess of not necessary rights.</p>
</div>
<div class="paragraph">
<p>Generally, the authorization server is the one that will check the permissions of a subject.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_data_security"><a class="anchor" href="#_data_security"></a>7.3. Data Security</h3>
<div class="paragraph">
<p>The data security concerns the way the data is stored. This is an extremely important part, because it is the most important asset of a company, and can cause a lot of problems about privacy, or even financial problems if they are stolen.</p>
</div>
<div class="paragraph">
<p>It is necessary to encrypt the sensitive data as much as possible.</p>
</div>
<div class="paragraph">
<p>First of all, all passwords must be hashed, and that with a strong salt. Basically, this is already done by the authentication server, which is the one that stores the passwords.</p>
</div>
<div class="paragraph">
<p>To encrypt the sensitive data (who needs to be read, not as a password), the cloud provider can provide a way to do it, or if you manage your own database, you can use its feature (if it exists).</p>
</div>
<div class="paragraph">
<p>The cons of this approach is that it is not possible to search in this data, and the encryption and decryption process can be very slow.</p>
</div>
</div>
<div class="sect2">
<h3 id="_secrets_management"><a class="anchor" href="#_secrets_management"></a>7.4. Secrets Management</h3>
<div class="paragraph">
<p>Secrets are sensitive data, such as passwords, tokens, certificates, etc. It is necessary to manage them correctly, and to ensure that they are not leaked. There are several ways to do it.</p>
</div>
<div class="paragraph">
<p>In a microservice architecture, we need to centralize the secrets management, to ensure that all services have the same secrets, and get them from a secure way, so that they are not leaked. There is some solutions to do it, like HashiCorp Vault, Azure Key Vault, or Kubernetes Secrets.</p>
</div>
<div class="paragraph">
<p>Here, because the chosen solution to PolyCode is HashiCorp Vault, we will explain how it works.</p>
</div>
<div class="sect3">
<h4 id="_hashicorp_vault"><a class="anchor" href="#_hashicorp_vault"></a>7.4.1. HashiCorp Vault</h4>
<div class="paragraph">
<p>HashiCorp Vault is a tool for securely storing and accessing secrets. It provides a centralized platform for managing sensitive information. Vault can also be used to generate dynamic credentials for services and applications, and to control access to those secrets through role-based access controls.</p>
</div>
<div class="paragraph">
<p>Here is a diagram showing the flow of HashiCorp Vault:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="questions/09%20-%20Security/images/HashiCorp%20Vault%20flow.png" alt="HashiCorp Vault flow">
</div>
<div class="title">Figure 48. HashiCorp Vault flow</div>
</div>
<div class="paragraph">
<p>As you can see, a service can get the secrets from Vault, using its own credentials. Vault will then check if the service is authorized to get the secrets with the RBAC, and if it is, it will return them.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_polycode_integration_2"><a class="anchor" href="#_polycode_integration_2"></a>7.5. PolyCode Integration</h3>
<div class="paragraph">
<p>For PolyCode, we will use some of the solutions explained before:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TLS everywhere</code>: We will use the sidecar level encryption, as explained before. This will ensure that all communication is encrypted, and that the data can&#8217;t be intercepted.</p>
</li>
<li>
<p><code>Service Authentication and Authorization</code> : We will use the Client Credentials Grant type, with our own Keycloak authorisation server, describe in the authentication part. This will ensure that only known services can communicate with each other.</p>
</li>
<li>
<p><code>Service Authorization</code>: Additionally, we will use the RBAC model, to ensure that the service can only do what it needs to do.</p>
</li>
<li>
<p><code>Data Encryption</code>: We will hash the passwords. For the other data, we will not encrypt them, because it will be too complicated and not necessary for now.</p>
</li>
<li>
<p><code>Secrets Management</code>: We will use HashiCorp Vault, to manage the secrets.</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_glossary"><a class="anchor" href="#_glossary"></a>Glossary</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">Microservices architecture</dt>
<dd>
<p>An architecture where the system is divided into multiple services that communicate with each other.</p>
</dd>
<dt class="hdlist1">Actors</dt>
<dd>
<p>It is a person that interacts with the system. It can be a user, a system, a third party, etc.</p>
</dd>
<dt class="hdlist1">User story</dt>
<dd>
<p>Informal, short and clear description of a feature from the perspective of the user. It takes the following format: <code>As a [actor], I want [feature], so that [benefit]</code>.</p>
</dd>
<dt class="hdlist1">Functionnal quarter</dt>
<dd>
<p>A functionnal quarter is a set of user stories that are related to a same feature.</p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="_bibliography"><a class="anchor" href="#_bibliography"></a>Bibliography</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Authentication</p>
</div>
<div class="paragraph">
<p><a href="https://curity.io/resources/openid-connect">OpenID Connect - curity.io</a><br>
<a href="https://blog.postman.com/pkce-oauth-how-to/">Oauth 2.0 with PKCE - postman.com</a><br>
<a href="https://www.loginradius.com/blog/engineering/pkce/">PKCE - loginradius.com</a><br>
<a href="https://www.youtube.com/watch?v=YdShQveywpo">[FR video] Oauth 2.1 simply explained</a><br>
<a href="https://www.youtube.com/watch?v=t18YB3xDfXI">[EN video] Oauth guide</a><br>
<a href="https://fusionauth.io/learn/expert-advice/oauth/differences-between-oauth-2-oauth-2-1#:~:text=OAuth%202.1%20is%20not%20a,a%20reference%20document%20going%20forward">OAuth 2.1 - fusionauth.io</a><br>
<a href="https://www.ibm.com/docs/en/cics-ts/6.1?topic=cics-openid-connect">Short explanation of OIDC - ibm.com</a><br>
<a href="https://connect2id.com/learn/openid-connect">OpenID Connect - connect2id.com</a><br>
<a href="https://jwt.io/introduction/">JWT - jwt.io</a><br>
<a href="https://www.ibm.com/docs/en/cics-ts/6.1?topic=cics-json-web-token-jwt">JWT - ibm.com</a><br>
<a href="https://openid.net/specs/openid-connect-core-1_0.html#StandardClaims">Standard claims - openid.net</a><br>
<a href="https://connect2id.com/learn/openid-connect#endpoints">OpenID Connect endpoints - connect2id.com</a><br>
<a href="https://heiswayi.nrird.com/sso-with-keycloak">Keycloak - heiswayi.nrird.com</a><br>
<a href="https://www.keycloak.org/getting-started/getting-started-docker">Keycloak get started (docker) - keycloak.org</a><br>
<a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-adod">Active Directory - microsoft.com</a><br>
<a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-adod/1fd2c193-fc70-4f90-a8c8-f1ca2de4e5ac">Active Directory: Provision a user - microsoft.com</a><br></p>
</div>
<div class="paragraph">
<p>IPC</p>
</div>
<div class="paragraph">
<p><a href="https://vishnuch.tech/interprocess-communication-in-microservices">IPC in Microservices - vishnuch.tech</a><br>
<a href="https://www.nginx.com/blog/building-microservices-inter-process-communication/">IPC in Microservices - nginx.com</a><br>
<a href="https://www.redhat.com/en/topics/api/what-is-a-rest-api">What is a REST API? - Red Hat</a><br>
<a href="https://restfulapi.net/rest-architectural-constraints/">REST Architectural Constraints - restfulapi.net</a><br>
<a href="https://grpc.io/docs/what-is-grpc/introduction/">What is gRPC? - gRPC.io</a><br>
<a href="https://developers.google.com/protocol-buffers/docs/overview">Protocol Buffers - developpers.google.com</a><br>
<a href="https://www.rabbitmq.com/">RabbitMQ - rabbitmq.com</a><br>
<a href="https://activemq.apache.org/">ActiveMQ - activemq.apache.org</a><br>
<a href="https://www.ibm.com/in-en/products/mq">IBM MQ - ibm.com</a><br>
<a href="https://en.wikipedia.org/wiki/Circuit_breaker_design_pattern">Circuit Breaker Design Pattern - wikipedia.org</a><br>
<a href="https://dzone.com/articles/performance-patterns-in-microservices-based-integr-1">Bulkhead Pattern - dzone.com</a><br>
<a href="https://www.redhat.com/en/topics/microservices/what-is-a-service-mesh">Service Mesh - Red Hat</a><br>
<a href="https://istio.io/latest/about/service-mesh/">Service Mesh - istio.io</a><br>
<a href="https://www.envoyproxy.io/">Envoy Proxy - envoyproxy.io</a><br>
<a href="https://iximiuz.com/en/posts/service-proxy-pod-sidecar-oh-my/">Service Proxy Pod Sidecar - iximiuz.com</a><br>
<a href="https://www.nginx.com/blog/service-discovery-in-a-microservices-architecture/">Service Discovery - nginx.com</a><br>
<a href="https://www.baeldung.com/cs/service-discovery-microservices">Service Discovery - baeldung.com</a><br>
<a href="https://www.rabbitmq.com/">RabbitMQ - rabbitmq.com</a><br>
<a href="https://developer.hashicorp.com/consul/docs/architecture">Consul Architecture - developer.hashicorp.com</a><br>
<a href="https://developer.hashicorp.com/consul/docs/connect/dataplane">Consul Simplified Architecture - developer.hashicorp.com</a><br>
<a href="https://developer.hashicorp.com/consul/docs/architecture/consensus">Consul Consensus - developer.hashicorp.com</a><br>
<a href="https://www.educative.io/answers/what-is-gossip-protocol">What is Gossip Protocol? - educative.io</a><br></p>
</div>
<div class="paragraph">
<p>Data management</p>
</div>
<div class="paragraph">
<p>Data management</p>
</div>
<div class="paragraph">
<p><a href="https://medium.com/@ggonchar/data-consistency-in-microservices-architecture-bf99ba31636f">Data Consistency in Microservices Architecture - medium.com</a><br>
<a href="https://www.postgresql.org/docs/current/app-pg-dumpall.html">pg_dumpall - postgresql.org</a><br></p>
</div>
<div class="paragraph">
<p>Security</p>
</div>
<div class="paragraph">
<p><a href="https://www.okta.com/resources/whitepaper/8-ways-to-secure-your-microservices-architecture/">8 Ways to Secure Your Microservices Architecture - okta.com</a><br>
<a href="https://medium.com/microservices-learning/how-to-implement-security-for-microservices-89b140d3e555">How to Implement Security for Microservices - medium.com</a><br>
<a href="https://geekflare.com/securing-microservices/">Securing Microservices - geekflare.com</a><br>
<a href="https://circleci.com/blog/sast-vs-dast-when-to-use-them/">SAST vs DAST: When to Use Them - circleci.com</a><br>
<a href="https://github.com/features/security/">Secure at every step - github.com</a><br>
<a href="https://community.microfocus.com/cyberres/b/sws-22/posts/sast-101-the-basics-of-static-application-security-testing">Static Application Security Testing (SAST) - community.microfocus.com</a><br>
<a href="https://auth0.com/docs/get-started/authentication-and-authorization-flow/client-credentials-flow">Client Credentials Flow - auth0.com</a><br>
<a href="https://digitalguardian.com/blog/what-role-based-access-control-rbac-examples-benefits-and-more">Role-Based Access Control (RBAC)? - digitalguardian.com</a><br>
<a href="https://arctype.com/blog/transparent-data-encryption/">Transparent Data Encryption in PostgreSQL - arctype.com</a><br>
<a href="https://wiki.postgresql.org/wiki/Transparent_Data_Encryption">Transparent Data Encryption - wiki.postgresql.org</a><br>
<a href="https://www.techmanyu.com/microservices-and-secrets-management-comparison-of-vault-solutions-2cae54037ad1">Secrets Management - techmanyu.com</a><br>
<a href="https://cloud.ibm.com/docs/secrets-manager?topic=secrets-manager-what-is-secret">Secrets Manager - cloud.ibm.com</a><br>
<a href="https://www.hashicorp.com/blog/authenticating-applications-with-vault-approle">Hashicorp Vault - hashicorp.com</a><br></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-01-22 20:05:44 UTC
</div>
</div>
</body>
</html>