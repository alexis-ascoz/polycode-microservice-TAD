<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<title>Authentication</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="_authentication">Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Authentication is the process of verifying the identity of a user or process. In this part, we will see the different authentication methods and how to implement them.</p>
</div>
<div class="sect2">
<h3 id="_oauth_2_0">Oauth 2.0</h3>
<div class="paragraph">
<p>OAuth 2.0 is an framework that enables websites or applications to access resources from others web applications, without having to share the user&#8217;s credentials.</p>
</div>
<div class="paragraph">
<p>Clearly, it allows a user to grant limited access to their resources on one site, to another site, without having to expose their password.</p>
</div>
<div class="sect3">
<h4 id="_terminologies">Terminologies</h4>
<div class="paragraph">
<p>With Oauth 2.0, it&#8217;s important to understand the different terms. Here is a list of the most important of them :</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Protected resource</dt>
<dd>
<p>The data you want to access. For example, a user&#8217;s profile information.</p>
</dd>
<dt class="hdlist1">Resource server</dt>
<dd>
<p>The server hosting the protected resource. This is the API you want to access.</p>
</dd>
<dt class="hdlist1">Authorization server</dt>
<dd>
<p>The server that authenticates the user and issues access tokens after getting proper authorization. This is the server that you use to log in to your account.</p>
</dd>
<dt class="hdlist1">Client</dt>
<dd>
<p>The application that wants to access the protected resource. For example, a mobile app or a website.</p>
</dd>
<dt class="hdlist1">Resource owner</dt>
<dd>
<p>The user that owns the protected resource. When the resource owner is a person, it is referred to as an end-user.</p>
</dd>
<dt class="hdlist1">Redirect URI</dt>
<dd>
<p>The URI to which the authorization server will redirect the user after obtaining authorization.</p>
</dd>
<dt class="hdlist1">Response type</dt>
<dd>
<p>The type of the response used to get the authorization code. The authorization code is used to get the access token.</p>
</dd>
<dt class="hdlist1">Scope</dt>
<dd>
<p>The scope of the access request. This is a list of space-delimited, case-sensitive strings, defined by the authorization server.</p>
</dd>
<dt class="hdlist1">Consent</dt>
<dd>
<p>The small box that asks the user if they want to allow the client to access their protected resources.</p>
</dd>
<dt class="hdlist1">Client ID</dt>
<dd>
<p>The client identifier issued to the client during the registration process. This is the public identifier for the client.</p>
</dd>
<dt class="hdlist1">Client Secret</dt>
<dd>
<p>The client secret issued to the client during the registration process. This is the secret known only to the client and the authorization server.</p>
</dd>
<dt class="hdlist1">Authorization Code</dt>
<dd>
<p>The temporary code issued by the authorization server in exchange for the access token request.</p>
</dd>
<dt class="hdlist1">Access token</dt>
<dd>
<p>The token issued by the authorization server. The client uses the access token to access the protected resource.</p>
</dd>
<dt class="hdlist1">Access token</dt>
<dd>
<p>The token issued by the authorization server. The client uses the refresh token to get a new access token.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_flows">Flows</h4>
<div class="paragraph">
<p>There is mutliple flow to authenticate a user. Here is the most common ones, and his differences.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Oauth%20flows%20comparaison.png" alt="Oauth flows comparaison">
</div>
<div class="title">Figure 1. Oauth flows comparaison</div>
</div>
<div class="sect4">
<h5 id="_authorization_code_flow">Authorization code flow</h5>
<div class="paragraph">
<p>The authorization code flow is the most secure one. It&#8217;s the one we will use in this project. Here is a diagram of this flow :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Authorization%20code%20flow.png" alt="Authorization code flow">
</div>
<div class="title">Figure 2. Authorization code flow</div>
</div>
<div class="paragraph">
<p>Because this flow will be used in PolyCode, we will explain it in details. Here are the steps of this flow :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The user makes a request to the client. In our case, it&#8217;s a login request.</p>
</li>
<li>
<p>The client request the authorization server to get an authorization code.</p>
</li>
<li>
<p>The authorization server redirect the user to a authentication and consent page</p>
</li>
<li>
<p>The user authenticate and grant the requested scope.</p>
</li>
<li>
<p>The authorization server redirect the user to the client, with the authorization code.</p>
</li>
<li>
<p>The client send the authorization code, with the client ID and the client secret, to the authorization server.</p>
</li>
<li>
<p>The authorization server validate the client ID and the client secret.</p>
</li>
<li>
<p>The authorization server send back the access token and the refresh token (and a ID token if the scope contains openid).</p>
</li>
<li>
<p>The client can now use the access token to access the protected resource in the resource server.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_implicit_flow">Implicit flow</h5>
<div class="paragraph">
<p>The implicit flow is the most simple one. In this flow, the authorization server return directly the token. This method is not secure and should not be used in production. Here is a diagram of this flow :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Implicit%20flow.png" alt="Implicit flow">
</div>
<div class="title">Figure 3. Implicit flow</div>
</div>
</div>
<div class="sect4">
<h5 id="_hybrid_flow">Hybrid flow</h5>
<div class="paragraph">
<p>The hybrid flow is the same as authorization code flow, but there is a token server that deliver the token, after authentication by the authorization server. Here is a diagram that explain the request path :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Hybrid%20flow.png" alt="Hybrid flow">
</div>
<div class="title">Figure 4. Hybrid flow</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_scope">Scope</h4>
<div class="paragraph">
<p>A access token permits to access to a protected resource. But, it&#8217;s not enough to access to all the resources. The authorization server can restrict the access, depending on the scope of the access token.</p>
</div>
<div class="paragraph">
<p>The score are asked by the client, in the query. Once the user is authenticated, the authorization server ask the user if he want to grant the requested scope, by displaying a consent page. If the user accept, the authorization server return the access token, with the requested scope.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jwt">JWT</h3>
<div class="paragraph">
<p>JWT (JSON Web Token) is an open standard that define a compact and URL-safe way to represent claims to be transferred between two parties. The claims in a JWT are encoded as a JSON object. He have a header, a payload and a signature. He also have a expiration date.</p>
</div>
<div class="paragraph">
<p>The JWT is used for the authentication in OpenID Connect. His integrity is verified by the signature, then no one can modify the data.</p>
</div>
<div class="sect3">
<h4 id="_anatomy">Anatomy</h4>
<div class="paragraph">
<p>Here is an explaination of the JWT parts :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/JWT%20decomposition.png" alt="JWT decomposition">
</div>
<div class="title">Figure 5. JWT decomposition</div>
</div>
</div>
<div class="sect3">
<h4 id="_claims">Claims</h4>
<div class="paragraph">
<p>The payload of a JWT contains claims. Claims are statements about an entity (typically, a user) and additional metadata.</p>
</div>
<div class="paragraph">
<p>There are three types of claims :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Registered claims</code>: These are a set of predefined claims which are not mandatory but recommended. Some of them are : iss (issuer), sub (subject), aud (audience), exp (expiration time), nbf (not before), iat (issued at), and jti (JWT ID).</p>
</li>
<li>
<p><code>Public claims</code>: These can be defined at will by those using JWTs. This can be used to share information between parties that agree on using the same claim names.</p>
</li>
<li>
<p><code>Private claims</code>: These are the custom claims created to share information between parties that agree on using them and are neither registered or public claims.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is an payload of an basic ID token used in OpenID Connect, with the definition of each claims :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ID%20token%20payload.png" alt="ID token payload">
</div>
<div class="title">Figure 6. ID token payload</div>
</div>
</div>
<div class="sect3">
<h4 id="_refresh_token">Refresh token</h4>
<div class="paragraph">
<p>Once the user is authenticated, the authorization server return an access token, valid for a certain amount of time. Once this token expires, the client can ask for a new one, using the refresh token. Here is a diagram of the flow to get a new token :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Refresh%20and%20access%20token.png" alt="Refresh and access token">
</div>
<div class="title">Figure 7. Refresh and access token</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_pkce">PKCE</h3>
<div class="paragraph">
<p>PKCE (Proof Key for Code Exchange) is an extension of Oauth 2.0. It&#8217;s a security feature that prevents an attacker from stealing the authorization code.</p>
</div>
<div class="sect3">
<h4 id="_terminologies_2">Terminologies</h4>
<div class="paragraph">
<p>Here is the terminologies used in PKCE :</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Code Verifier</dt>
<dd>
<p>A huge random string (43 to 128 chars) generated by the client. It&#8217;s used to generate the code challenge, and is not sent to the authorization server.</p>
</dd>
<dt class="hdlist1">Code challenge</dt>
<dd>
<p>A base 64 encoded string of the code verifier. It&#8217;s sent to the authorization server.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_flow">Flow</h4>
<div class="paragraph">
<p>When the client send the authorization request to the authorization server, he also send the code challenge and the code challenge method (but not the code verifier).</p>
</div>
<div class="paragraph">
<p>Then, when the client send back the authorization code to the authorization server, he also send the code verifier. The authorization server then hash the code verifier and compare it to the code challenge. If they match, the authorization server send back the access token. Here is a diagram of this flow :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Authorization%20code%20flow%20with%20PKCE.png" alt="Authorization code flow with PKCE">
</div>
<div class="title">Figure 8. Authorization code flow with PKCE</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_oauth_2_1">Oauth 2.1</h3>
<div class="paragraph">
<p>Oauth 2.1 is not a new protocol, but a reference document. It&#8217;s a consolidation of best practices in Oauth 2.0. Here is the differences between Oauth 2.0 and Oauth 2.1 :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PKCE (Proof Key for Code Exchange) is mandatory.</p>
</li>
<li>
<p>Redirect URI must be compared using exact string matching.</p>
</li>
<li>
<p>Implicit flow is not allowed.</p>
</li>
<li>
<p>Resource owner password credentials grant flow is not allowed (because with this flow, the client can access to the user&#8217;s password).</p>
</li>
<li>
<p>Bearer token usage requires the use of the HTTP Authorization header field instead of the query parameter.</p>
</li>
<li>
<p>Refresh tokens must be bound to the client that requested them, or be one-time use.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_sso">SSO</h3>
<div class="paragraph">
<p>SSO (Single Sign On) is a protocol that allows a user to authenticate once to access multiple applications. With this property, a user logs in with a single ID and password to gain access to a connected system. The user is then signed in to all other systems that are part of the SSO infrastructure. This is in contrast to having to log in separately to each system.</p>
</div>
<div class="paragraph">
<p>An example of SSO is a student logging in to a university&#8217;s portal to access email, course registration, and other services.</p>
</div>
</div>
<div class="sect2">
<h3 id="_openid_connect">OpenID Connect</h3>
<div class="paragraph">
<p>OpenID Connect (OIDC) is an authentication layer on top of Oauth 2.0. It&#8217;s a protocol that allows clients to verify the identity of the end-user based on the authentication performed by an authorization server, as well as to obtain basic profile information about the end-user in an interoperable and REST-like manner.</p>
</div>
<div class="sect3">
<h4 id="_oidc_scopes">OIDC scopes</h4>
<div class="paragraph">
<p>There is multiple scopes in OIDC. Let&#8217;s see the most common ones :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/OIDC%20scopes.png" alt="OIDC scopes">
</div>
<div class="title">Figure 9. OIDC scopes</div>
</div>
</div>
<div class="sect3">
<h4 id="_endpoints">Endpoints</h4>
<div class="paragraph">
<p>Here is the endpoints defines in OIDC :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/OIDC%20endpoints.png" alt="OIDC endpoints">
</div>
<div class="title">Figure 10. OIDC endpoints</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ldap">LDAP</h3>
<div class="paragraph">
<p>LDAP (Lightweight Directory Access Protocol) is a protocol that allows to access to a directory service. It&#8217;s a client-server protocol, and the client can be a user or an application.</p>
</div>
<div class="paragraph">
<p>In the case of PolyCode, we will use the polytech LDAP server to manage the users and groups of our applications. In this way, any guest who has an account on the Polytech network can access to polycode without creating a new account.</p>
</div>
</div>
<div class="sect2">
<h3 id="_tools">Tools</h3>
<div class="paragraph">
<p>There is multiple tools to help you to implement Oauth 2.0 and OpenID Connect in your application. This part will explain the most common ones and how to use them.</p>
</div>
<div class="sect3">
<h4 id="_keycloak">KeyCloak</h4>
<div class="paragraph">
<p>KeyCloak is an open source identity and access management solution. It&#8217;s a single sign-on solution that allows you to manage users, applications, roles, groups, etc. It&#8217;s an Oauth 2.0, OpenID Connect and SAML 2.0 compliant solution.</p>
</div>
<div class="paragraph">
<p>With the graphical interface, you can manage easily and quickly your resources. It supports multiple factors authentication and social login, all with a lot of adapters to integrate it in your application.</p>
</div>
<div class="paragraph">
<p>Here is an image of the keycloak architecture :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Keycloak%20architecture.png" alt="Keycloak architecture">
</div>
<div class="title">Figure 11. Keycloak architecture</div>
</div>
<div class="paragraph">
<p>In the case of PolyCode, we will use KeyCloak to manage the authentication and authorization of our users and services.</p>
</div>
</div>
<div class="sect3">
<h4 id="_others_solutions">Others solutions</h4>
<div class="paragraph">
<p>There is multiple other solutions to manage the authentication and authorization of your users and services. Because we will use KeyCloak for PolyCode, we have detailed it in the previous section.</p>
</div>
<div class="paragraph">
<p>Here is a list of other possible solutions :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Okta</code> (Cloud service)</p>
</li>
<li>
<p><code>Auth0</code> (Cloud service)</p>
</li>
<li>
<p><code>FusionAuth</code> (Open source solution)</p>
</li>
<li>
<p><code>AWS Cognito</code> (Cloud service)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_polycode_authentication_migration">PolyCode authentication migration</h3>
<div class="paragraph">
<p>For now, we use an Oauth2 system, with our own implementation. We will migrate this to KeyCloak, to have a more robust and scalable solution. Note that we will not migrate the authorization part, because is not the purpose here.</p>
</div>
<div class="sect3">
<h4 id="_architecture">Architecture</h4>
<div class="paragraph">
<p>Here is a diagram of the wanted architecture :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/PolyCode%20authentication%20architecture%20schema.png" alt="PolyCode authentication architecture schema">
</div>
<div class="title">Figure 12. PolyCode authentication architecture schema</div>
</div>
<div class="paragraph">
<p>The goal is to have a KeyCloak instance, with a client for each service. Each service will have a client secret, and will use it to authenticate to KeyCloak.</p>
</div>
<div class="paragraph">
<p>The user, when he wants to access to some resources, will be redirected to KeyCloak. He will authenticate with his credentials (or create new), and will be redirected back to the PolyCode UI with a code. The UI will then exchange this code with KeyCloak, and will get an access token. This token will be used to authenticate to PolyCode, verify by KeyCloak against the Polycode API, and will be used to access to the resources.</p>
</div>
<div class="paragraph">
<p>To do this, we will follow multiple steps. This document is based on the <a href="https://www.keycloak.org/getting-started/getting-started-docker">official KeyCloak documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_setup_keycloak">Setup KeyCloak</h4>
<div class="paragraph">
<p>First, we need to setup a KeyCloak instance. You can use the docker image, or install it on your server. You can run a KeyCloak instance in dev mode with the following command :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">docker run -p 8080:8080 -e KEYCLOAK_ADMIN=admin -e KEYCLOAK_ADMIN_PASSWORD=admin quay.io/keycloak/keycloak:20.0.2 start-dev</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configure_keycloak">Configure KeyCloak</h4>
<div class="paragraph">
<p>Once the KeyCloak instance is running, you can access it at <a href="http://localhost:8080" class="bare">http://localhost:8080</a> with the <code>admin</code>/<code>admin</code> credentials if you used the command above.</p>
</div>
<div class="paragraph">
<p>Once logged in, you can create a new realm. A realm is a group of users, applications, and clients. You can create multiple realms in KeyCloak, and each realm is isolated from the others. For PolyCode, we will create a <code>polycode</code> realm.</p>
</div>
</div>
<div class="sect3">
<h4 id="_keycloak_clients">KeyCloak clients</h4>
<div class="paragraph">
<p>A client is an application that wants to use KeyCloak to authenticate users. You can create multiple clients in a realm. For PolyCode, we will create two clients :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>polycode</code>: The client for the PolyCode application frontend.</p>
</li>
<li>
<p><code>polycode-api</code>: The client for the PolyCode API.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each client have multiple settings :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Client ID</code>: The unique identifier of the client.</p>
</li>
<li>
<p><code>Client Protocol</code>: The protocol used by the client. We will use <code>openid-connect</code>.</p>
</li>
<li>
<p><code>Valid Redirect URIs</code>: The list of valid redirect URIs for the client. For the <code>polycode</code> client, we will use <code>&lt;frontend_url&gt;/auth/callback</code>. For the <code>polycode-api</code> client, we will use <code>&lt;api_url&gt;/auth/callback</code>.</p>
</li>
<li>
<p><code>Web Origins</code>: The list of valid web origins for the client. For now, we will use <code>*</code> to allow all origins.</p>
</li>
<li>
<p><code>Credentials</code>: The credentials used by the client to authenticate to KeyCloak. You can find this in the <code>Credentials</code> tab.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For better security, you can also uncheck the <code>Implicit Flow</code> option.</p>
</div>
</div>
<div class="sect3">
<h4 id="_keycloak_users">KeyCloak users</h4>
<div class="paragraph">
<p>In our case, we don&#8217;t need to configure users, roles, groups, etc. because authorization will be managed by the API.</p>
</div>
</div>
<div class="sect3">
<h4 id="_polycode_integration_poc">PolyCode integration - POC</h4>
<div class="paragraph">
<p>Now, we need to integrate KeyCloak in PolyCode. We will explain how to do this with a POC. Here is the project links :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://gitlab.polytech.umontpellier.fr/alexis.bernard01/poc-frontend-keycloack">Polycode-keycloak</a></p>
</li>
<li>
<p><a href="https://gitlab.polytech.umontpellier.fr/alexis.bernard01/poc-backend-keycloack">Polycode-keycloak-api</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To run the POC, you need first to run the backend, then the frontend, and finally the runner. The backend contains already a KeyCloak instance (not configured).</p>
</div>
<div class="paragraph">
<p>Then, you can access the polycode-keycloak application at <a href="http://localhost:3001" class="bare">http://localhost:3001</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_deployments">Deployments</h4>
<div class="paragraph">
<p>Here is the deployment diagram of the future PolyCode authentication architecture :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/PolyCode%20authentication%20deployment%20schema.png" alt="PolyCode authentication deployment schema">
</div>
<div class="title">Figure 13. PolyCode authentication deployment schema</div>
</div>
<div class="paragraph">
<p>All communications between those services are in HTTP, and are secured with TLS.</p>
</div>
</div>
<div class="sect3">
<h4 id="_sequence_diagrams">Sequence diagrams</h4>
<div class="paragraph">
<p>Here is some sequence diagrams to explain the differences between the authentication process modes.</p>
</div>
<div class="sect4">
<h5 id="_vanilla_user_account_creation">Vanilla user account creation</h5>
<div class="paragraph">
<p>Here is the sequence diagram of the user account creation :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/PolyCode%20authentication%20sequence%20diagram%20-%20Vanilla%20user%20account%20creation.png" alt="PolyCode authentication sequence diagram   Vanilla user account creation">
</div>
<div class="title">Figure 14. PolyCode authentication sequence diagram - Vanilla user account creation</div>
</div>
</div>
<div class="sect4">
<h5 id="_user_account_creation_via_polytech_ldap">User account creation via polytech LDAP</h5>
<div class="paragraph">
<p>Here is the sequence diagram of the user account creation via polytech LDAP :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/PolyCode%20authentication%20sequence%20diagram%20-%20Polytech%20LDAP%20account%20creation.png" alt="PolyCode authentication sequence diagram   Polytech LDAP account creation">
</div>
<div class="title">Figure 15. PolyCode authentication sequence diagram - Polytech LDAP account creation</div>
</div>
</div>
<div class="sect4">
<h5 id="_user_account_creation_via_google">User account creation via google</h5>
<div class="paragraph">
<p>Here is the sequence diagram of the user account creation via google :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/PolyCode%20authentication%20sequence%20diagram%20-%20Google%20identity%20provider%20user%20account%20creation.png" alt="PolyCode authentication sequence diagram   Google identity provider user account creation">
</div>
<div class="title">Figure 16. PolyCode authentication sequence diagram - Google identity provider user account creation</div>
</div>
</div>
<div class="sect4">
<h5 id="_vanilla_user_authentication">Vanilla user authentication</h5>
<div class="paragraph">
<p>Here is the sequence diagram of the user authentication :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/PolyCode%20authentication%20sequence%20diagram%20-%20Vanilla%20user%20authentication.png" alt="PolyCode authentication sequence diagram   Vanilla user authentication">
</div>
<div class="title">Figure 17. PolyCode authentication sequence diagram - Vanilla user authentication</div>
</div>
</div>
<div class="sect4">
<h5 id="_polytech_ldap_user_authentication">Polytech LDAP user authentication</h5>
<div class="paragraph">
<p>Here is the sequence diagram of the Polytech LDAP user authentication :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/PolyCode%20authentication%20sequence%20diagram%20-%20Polytech%20LDAP%20user%20authentication.png" alt="PolyCode authentication sequence diagram   Polytech LDAP user authentication">
</div>
<div class="title">Figure 18. PolyCode authentication sequence diagram - Polytech LDAP user authentication</div>
</div>
</div>
<div class="sect4">
<h5 id="_user_authentication_via_google">User authentication via google</h5>
<div class="paragraph">
<p>Here is the sequence diagram of the user authentication via google :</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/PolyCode%20authentication%20sequence%20diagram%20-%20Google%20identity%20provider%20user%20authentication.png" alt="PolyCode authentication sequence diagram   Google identity provider user authentication">
</div>
<div class="title">Figure 19. PolyCode authentication sequence diagram - Google identity provider user authentication</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-01-22 20:05:44 UTC
</div>
</div>
</body>
</html>